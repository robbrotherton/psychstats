<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.78">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Psych Stats - (Un)Biased estimates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script type="ojs-define">
{"contents":[{"name":"data","value":[{"value":-4,"density":0.0001},{"value":-3.96,"density":0.0002},{"value":-3.92,"density":0.0002},{"value":-3.88,"density":0.0002},{"value":-3.84,"density":0.0003},{"value":-3.8,"density":0.0003},{"value":-3.76,"density":0.0003},{"value":-3.72,"density":0.0004},{"value":-3.68,"density":0.0005},{"value":-3.64,"density":0.0005},{"value":-3.6,"density":0.0006},{"value":-3.56,"density":0.0007},{"value":-3.52,"density":0.0008},{"value":-3.48,"density":0.0009},{"value":-3.44,"density":0.0011},{"value":-3.4,"density":0.0012},{"value":-3.36,"density":0.0014},{"value":-3.32,"density":0.0016},{"value":-3.28,"density":0.0018},{"value":-3.24,"density":0.0021},{"value":-3.2,"density":0.0024},{"value":-3.16,"density":0.0027},{"value":-3.12,"density":0.0031},{"value":-3.08,"density":0.0035},{"value":-3.04,"density":0.0039},{"value":-3,"density":0.0044},{"value":-2.96,"density":0.005},{"value":-2.92,"density":0.0056},{"value":-2.88,"density":0.0063},{"value":-2.84,"density":0.0071},{"value":-2.8,"density":0.0079},{"value":-2.76,"density":0.0088},{"value":-2.72,"density":0.0099},{"value":-2.68,"density":0.011},{"value":-2.64,"density":0.0122},{"value":-2.6,"density":0.0136},{"value":-2.56,"density":0.0151},{"value":-2.52,"density":0.0167},{"value":-2.48,"density":0.0184},{"value":-2.44,"density":0.0203},{"value":-2.4,"density":0.0224},{"value":-2.36,"density":0.0246},{"value":-2.32,"density":0.027},{"value":-2.28,"density":0.0297},{"value":-2.24,"density":0.0325},{"value":-2.2,"density":0.0355},{"value":-2.16,"density":0.0387},{"value":-2.12,"density":0.0422},{"value":-2.08,"density":0.0459},{"value":-2.04,"density":0.0498},{"value":-2,"density":0.054},{"value":-1.96,"density":0.0584},{"value":-1.92,"density":0.0632},{"value":-1.88,"density":0.0681},{"value":-1.84,"density":0.0734},{"value":-1.8,"density":0.079},{"value":-1.76,"density":0.0848},{"value":-1.72,"density":0.0909},{"value":-1.68,"density":0.0973},{"value":-1.64,"density":0.104},{"value":-1.6,"density":0.1109},{"value":-1.56,"density":0.1182},{"value":-1.52,"density":0.1257},{"value":-1.48,"density":0.1334},{"value":-1.44,"density":0.1415},{"value":-1.4,"density":0.1497},{"value":-1.36,"density":0.1582},{"value":-1.32,"density":0.1669},{"value":-1.28,"density":0.1758},{"value":-1.24,"density":0.1849},{"value":-1.2,"density":0.1942},{"value":-1.16,"density":0.2036},{"value":-1.12,"density":0.2131},{"value":-1.08,"density":0.2227},{"value":-1.04,"density":0.2323},{"value":-1,"density":0.242},{"value":-0.96,"density":0.2516},{"value":-0.92,"density":0.2613},{"value":-0.88,"density":0.2709},{"value":-0.84,"density":0.2803},{"value":-0.8,"density":0.2897},{"value":-0.76,"density":0.2989},{"value":-0.72,"density":0.3079},{"value":-0.68,"density":0.3166},{"value":-0.64,"density":0.3251},{"value":-0.6,"density":0.3332},{"value":-0.56,"density":0.341},{"value":-0.52,"density":0.3485},{"value":-0.48,"density":0.3555},{"value":-0.44,"density":0.3621},{"value":-0.4,"density":0.3683},{"value":-0.36,"density":0.3739},{"value":-0.32,"density":0.379},{"value":-0.28,"density":0.3836},{"value":-0.24,"density":0.3876},{"value":-0.2,"density":0.391},{"value":-0.16,"density":0.3939},{"value":-0.12,"density":0.3961},{"value":-0.08,"density":0.3977},{"value":-0.04,"density":0.3986},{"value":0,"density":0.3989},{"value":0.04,"density":0.3986},{"value":0.08,"density":0.3977},{"value":0.12,"density":0.3961},{"value":0.16,"density":0.3939},{"value":0.2,"density":0.391},{"value":0.24,"density":0.3876},{"value":0.28,"density":0.3836},{"value":0.32,"density":0.379},{"value":0.36,"density":0.3739},{"value":0.4,"density":0.3683},{"value":0.44,"density":0.3621},{"value":0.48,"density":0.3555},{"value":0.52,"density":0.3485},{"value":0.56,"density":0.341},{"value":0.6,"density":0.3332},{"value":0.64,"density":0.3251},{"value":0.68,"density":0.3166},{"value":0.72,"density":0.3079},{"value":0.76,"density":0.2989},{"value":0.8,"density":0.2897},{"value":0.84,"density":0.2803},{"value":0.88,"density":0.2709},{"value":0.92,"density":0.2613},{"value":0.96,"density":0.2516},{"value":1,"density":0.242},{"value":1.04,"density":0.2323},{"value":1.08,"density":0.2227},{"value":1.12,"density":0.2131},{"value":1.16,"density":0.2036},{"value":1.2,"density":0.1942},{"value":1.24,"density":0.1849},{"value":1.28,"density":0.1758},{"value":1.32,"density":0.1669},{"value":1.36,"density":0.1582},{"value":1.4,"density":0.1497},{"value":1.44,"density":0.1415},{"value":1.48,"density":0.1334},{"value":1.52,"density":0.1257},{"value":1.56,"density":0.1182},{"value":1.6,"density":0.1109},{"value":1.64,"density":0.104},{"value":1.68,"density":0.0973},{"value":1.72,"density":0.0909},{"value":1.76,"density":0.0848},{"value":1.8,"density":0.079},{"value":1.84,"density":0.0734},{"value":1.88,"density":0.0681},{"value":1.92,"density":0.0632},{"value":1.96,"density":0.0584},{"value":2,"density":0.054},{"value":2.04,"density":0.0498},{"value":2.08,"density":0.0459},{"value":2.12,"density":0.0422},{"value":2.16,"density":0.0387},{"value":2.2,"density":0.0355},{"value":2.24,"density":0.0325},{"value":2.28,"density":0.0297},{"value":2.32,"density":0.027},{"value":2.36,"density":0.0246},{"value":2.4,"density":0.0224},{"value":2.44,"density":0.0203},{"value":2.48,"density":0.0184},{"value":2.52,"density":0.0167},{"value":2.56,"density":0.0151},{"value":2.6,"density":0.0136},{"value":2.64,"density":0.0122},{"value":2.68,"density":0.011},{"value":2.72,"density":0.0099},{"value":2.76,"density":0.0088},{"value":2.8,"density":0.0079},{"value":2.84,"density":0.0071},{"value":2.88,"density":0.0063},{"value":2.92,"density":0.0056},{"value":2.96,"density":0.005},{"value":3,"density":0.0044},{"value":3.04,"density":0.0039},{"value":3.08,"density":0.0035},{"value":3.12,"density":0.0031},{"value":3.16,"density":0.0027},{"value":3.2,"density":0.0024},{"value":3.24,"density":0.0021},{"value":3.28,"density":0.0018},{"value":3.32,"density":0.0016},{"value":3.36,"density":0.0014},{"value":3.4,"density":0.0012},{"value":3.44,"density":0.0011},{"value":3.48,"density":0.0009},{"value":3.52,"density":0.0008},{"value":3.56,"density":0.0007},{"value":3.6,"density":0.0006},{"value":3.64,"density":0.0005},{"value":3.68,"density":0.0005},{"value":3.72,"density":0.0004},{"value":3.76,"density":0.0003},{"value":3.8,"density":0.0003},{"value":3.84,"density":0.0003},{"value":3.88,"density":0.0002},{"value":3.92,"density":0.0002},{"value":3.96,"density":0.0002},{"value":4,"density":0.0001}]}]}
</script>
<script type="ojs-define">
{"contents":[{"name":"population","value":[[0.2601],[-0.5257],[0.9582],[0.6527],[1.7287],[0.7492],[-1.2904],[-0.1848],[1.9988],[1.8749],[0.6222],[0.052],[0.4323],[-0.0109],[0.0713],[0.2107],[1.2416],[-0.01],[-0.0681],[-0.2576],[1.6306],[0.2067],[1.3892],[1.3692],[0.6495],[-0.2571],[1.3357],[0.9775],[-0.9248],[1.3194],[0.1946],[1.1246],[-0.7449],[-1.4984],[0.9271],[-0.3829],[-0.1996],[1.0026],[-0.4465],[-0.6241],[1.4266],[0.2237],[1.3736],[-1.7115],[-0.814],[-0.8566],[0.1381],[-0.353],[0.7851],[-1.8246],[-0.6512],[-0.6098],[-0.0466],[0.4867],[2.0758],[-0.5819],[-0.5361],[0.7561],[-0.1253],[1.432],[-1.0702],[1.1375],[-1.323],[2.1718],[0.1718],[-0.204],[-0.3755],[0.9564],[0.5804],[-0.1415],[0.2],[-0.4669],[-0.9567],[0.2226],[0.7828],[-0.3467],[0.2816],[-0.6535],[-0.789],[-0.0177],[1.3678],[-0.1859],[-0.5591],[-1.4865],[-1.0332],[-1.3166],[-0.8319],[-1.1345],[0.4175],[-0.1731],[-1.2867],[-0.7902],[0.2004],[0.6721],[0.7478],[-0.0129],[2.4478],[-0.562],[1.0382],[-0.2515],[0.7446],[-0.0834],[-0.3332],[-0.0737],[0.0822],[-1.7509],[1.6461],[0.8394],[-1.1012],[-1.7528],[0.4784],[0.8064],[0.9313],[0.3518],[-0.0822],[0.4743],[-0.7899],[-0.5896],[1.8109],[-0.7053],[-0.1021],[-0.999],[1.9752],[-0.3134],[1.0432],[1.0582],[-0.9385],[0.3972],[-0.5795],[-2.43],[1.1516],[0.7274],[-0.9627],[-2.0087],[-0.5695],[1.039],[0.6074],[-0.0493],[-1.6997],[1.2909],[1.0714],[0.7803],[-0.8382],[0.6796],[-0.7122],[-0.4295],[-1.2016],[0.4399],[-0.4987],[0.9775],[0.9435],[-0.809],[1.629],[1.4585],[-0.4644],[0.6054],[-0.8516],[-0.696],[-2.1348],[1.1738],[0.3898],[0.5438],[-0.9289],[-1.4422],[1.0457],[-1.5648],[0.0541],[-0.7661],[-0.2016],[-0.2482],[1.8948],[-0.4591],[-0.5798],[-2.3013],[1.7774],[0.1106],[-0.4197],[0.6843],[-0.7921],[-1.1318],[-1.0252],[0.1093],[0.4309],[-1.6437],[2.0029],[-0.7055],[0.4296],[0.4921],[0.3021],[-0.15],[-0.6785],[0.0353],[0.6212],[-1.2153],[-0.3225],[-0.6372],[-0.885],[1.5646],[-1.2016],[1.8476],[1.2931],[-1.5663],[-0.2771],[1.1114],[-0.759],[1.6139],[-2.4712],[0.6116],[1.1801],[0.208],[-0.1976],[-0.2006],[-0.2263],[2.1766],[1.6745],[-1.0434],[0.0271],[-1.3451],[0.1874],[-0.7797],[-0.2634],[0.726],[-0.1056],[0.2677],[1.1921],[-1.4531],[0.6924],[-0.4809],[1.2015],[-0.0679],[-1.113],[0.7168],[-0.009],[0.6862],[-0.9339],[-0.3341],[-0.0109],[-0.3245],[-0.3358],[0.4453],[-0.9827],[0.0123],[-0.8798],[0.5378],[-0.8249],[1.2501],[0.0989],[0.198],[0.5211],[0.6],[0.4452],[-0.9179],[-0.6645],[-1.9763],[0.16],[1.3462],[-1.1007],[0.489],[0.6738],[0.0543],[-1.2469],[-0.4861],[1.3987],[0.8581],[0.5378],[2.4899],[-0.2558],[0.2417],[0.8744],[-0.0908],[1.0788],[0.5715],[-0.2023],[-0.1377],[-2.5271],[-0.5865],[0.0684],[1.3049],[-0.688],[-1.5211],[-0.1973],[0.0265],[-1.4944],[-1.8768],[-0.8399],[1.3355],[-1.3621],[0.3709],[0.1587],[0.7082],[0.7413],[2.6416],[0.3489],[-0.6513],[0.1009],[-1.1935],[-0.3995],[-0.7381],[-0.095],[-1.0186],[-2.9034],[1.6002],[1.5287],[0.5589],[-0.7481],[0.2938],[-0.2922],[0.1423],[-0.1833],[0.3158],[-0.282],[0.9568],[0.4374],[-2.3183],[-0.5335],[0.3777],[-0.5833],[-1.2705],[0.8258],[0.9062],[0.1995],[1.119],[-0.64],[-0.9586],[-0.1724],[0.7537],[-0.9972],[-0.9989],[-0.3403],[1.1305],[1.1526],[1.3172],[0.9198],[-0.8063],[-0.345],[1.1926],[0.1535],[-0.4244],[-1.4606],[-0.3621],[0.6497],[0.2894],[-1.7712],[0.1004],[-1.0883],[-0.0755],[0.5028],[1.1685],[0.9735],[-0.9967],[-0.7052],[0.4732],[0.4839],[0.1233],[0.6072],[-0.5208],[0.1659],[1.0749],[1.1452],[-0.4304],[1.0278],[0.9718],[-1.2387],[-0.2649],[-1.6743],[0.0745],[-2.0785],[0.1509],[0.3579],[-0.6255],[1.0012],[-0.2465],[1.3212],[-1.0621],[1.9901],[-1.1733],[0.4695],[-1.6746],[0.2189],[-0.1132],[2.4813],[1.2954],[0.4532],[0.6958],[-0.8845],[-1.3255],[0.2202],[-1.4379],[-1.5206],[-1.0773],[0.1825],[0.3072],[1.2715],[-1.7103],[0.2842],[-1.1282],[-0.8442],[-0.3148],[-0.026],[-0.1235],[-1.1878],[0.508],[-0.2109],[0.8764],[-0.7205],[-2.2354],[1.0724],[1.2441],[0.8324],[1.6794],[0.3994],[-0.5173],[-0.2591],[-0.0188],[0.1025],[-0.5632],[0.0227],[0.9732],[-0.4929],[0.259],[-0.5685],[-1.2239],[0.212],[0.1715],[-0.2122],[-0.5506],[0.0762],[-1.9423],[0.0098],[0.7242],[1.4051],[3.3212],[-1.8983],[-1.3596],[2.4202],[0.3002],[0.9345],[0.4041],[-1.1499],[0.342],[-0.6846],[1.2623],[1.6144],[0.4714],[1.6496],[1.7213],[0.215],[-0.3153],[-1.2862],[0.0983],[-1.1383],[-0.0298],[-0.7225],[1.1475],[1.5665],[-2.586],[-0.8127],[0.3658],[-0.9683],[-0.3639],[-0.0018],[0.8507],[0.48],[0.7153],[-0.739],[0.0481],[-0.5923],[1.4911],[-0.6164],[-0.8696],[-1.1991],[0.4163],[-0.6888],[-0.4046],[1.085],[0.471],[1.4076],[1.1168],[-0.64],[-1.6822],[-1.5271],[0.3596],[-1.9284],[-0.5907],[-0.3276],[-1.01],[-0.4284],[0.9342],[0.1177],[-0.6542],[-0.0754],[0.5276],[-0.8304],[0.4789],[-0.6328],[0.6326],[-0.0582],[-0.1431],[-0.4396],[-0.5663],[-1.6666],[-0.8129],[-1.7013],[0.4748],[-0.3252],[-0.0184],[-0.2485],[0.5691],[-1.3155],[1.7944],[-0.4844],[-0.2798],[-0.642],[0.3189],[-1.7488],[-0.471],[-0.1051],[-0.3854],[1.6426],[0.9315],[0.3966],[-1.2668],[0.5283],[0.9393],[-0.5269],[0.237],[0.4486],[0.1709],[-0.5797],[0.7621],[-0.1236],[0.6423],[1.2445],[-2.3475],[0.8847],[0.7832],[0.1368],[1.7309],[-0.5225],[-0.4328],[-1.25],[0.0816],[0.043],[-0.9926],[0.7761],[0.6571],[-0.0211],[0.758],[0.8788],[-2.3662]]}]}
</script>
<link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/tex-gyre-adventor" type="text/css">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title"><svg id="logo-svg" viewbox="0 0 170 40"><polyline class="logo-path" points="0,38 1.99999999999999,38 4,38 6,38 8.00000000000001,38 10,38 12,38 14,38 16,38 18,38 20,38 22,38 24,38 26,38 28,38 30,38 32,38 34,38 36,38 38,38 40,38 42,38 44,37.99999 46,37.99998 48,37.99995 50,37.99987 52,37.99964 54,37.99908 56,37.99775 58,37.99468 60,37.98792 62,37.97366 64,37.94478 66,37.88881 68,37.78486 70,37.60008 72,37.28572 74,36.77429 76,35.97915 78,34.79882 80,33.12793 82,30.87565 84,27.99066 86,24.4888 88,20.47692 90,16.1649 92,11.85863 94,7.93027 96,4.76781 98,2.71285 100,2 102,2.71285 104,4.76781 106,7.93027 108,11.85863 110,16.1649 112,20.47692 114,24.4888 116,27.99066 118,30.87565 120,33.12793 122,34.79882 124,35.97915 126,36.77429 128,37.28572 130,37.60008 132,37.78486 134,37.88881 136,37.94478 138,37.97366 140,37.98792 142,37.99468 144,37.99775 146,37.99908 148,37.99964 150,37.99987 152,37.99995 154,37.99998 156,37.99999 158,38 160,38 162,38 164,38 166,38 168,38 170,38 172,38 174,38 176,38 178,38 180,38 182,38 184,38 186,38 188,38 190,38 192,38 194,38 196,38 198,38 200,38"></polyline><text class="logo-text" x="0" y="30">PSYCH</text><text class="logo-text" x="185" y="30" text-anchor="end">STATS</text></svg></span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/rob_brotherton" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/robbrotherton/psychstats" rel="" target="">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/robbrotherton/psychstats/issues/new" rel="" target="">
 <span class="dropdown-text">Report a Bug</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">(Un)Biased estimates</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div id="controls">
<div id="controls-container">

</div>
<div id="select-estimate">
<p>Show: <span class="select-mean selector unselected"><span class="math inline">\(M\)</span></span> <span class="select-population selector"><span class="math inline">\(SD_{n}\)</span></span> <span class="select-sample selector"><span class="math inline">\(SD_{n - 1}\)</span></span></p>
</div>
</div>
<div id="viz" style="margin-bottom: 1em; overflow: hidden;">
<div id="population-container">

</div>
<div id="timeline-container">

</div>
</div>
<section id="about" class="level2">
<h2 class="anchored" data-anchor-id="about">About</h2>
<p>To say a statistic is <em>unbiased</em> is to say that, <em>on average</em>, its value is equal to the parameter it is estimating. Sampling error, the inherent randomness which determines which observations appear in the sample, ensures that each individual sample will produce a different estimate; any given sample’s statistic won’t be exactly equal to the parameter. But if many samples are taken, the average of all those statistics will converge on the true population parameter’s value.</p>
<p>The arithmetic average is an unbiased statistic. Each sample’s mean will be different, some above the true population mean and some below. Because the discrepancy is random, however, with many samples the overestimates and underestimates balance out. The average of all the differences between each sample average and the true population average will be close to zero. That’s what makes the mean unbiased.</p>
<p>Standard deviation is more complicated. There are two different equations for standard deviation. In both cases, you first calculate the mean, then the sum of squared deviations from the mean. If the data represents a complete population, you then divide the sum of squared deviations by <em>N</em>, the total number of observations in the entire population. With data from a sample, however, you divide by <em>n - 1</em>, the number of scores in the sample minus 1. This is because if you use the first approach with data from a sample, dividing by <em>N</em>, the statistic will be <em>biased</em>.</p>
<p>More specifically, using the population standard deviation equation with sample data has the effect of systematically <em>underestimating</em> the population parameter. As with the mean, each sample produces a slightly different estimate, but unlike the mean, the difference between estimate and parameter is not completely random. More samples will underestimate the population variability than overestimate it. As a result, the average of all sample estimates of standard deviation would be lower than the true population value.</p>
<p>Dividing by <em>n - 1</em> when calculating a sample’s standard deviation corrects for that bias, producing an unbiased estimate. Why? It has to do with the fact that the standard deviation is a measure of variability, a measure of how spread out the data is. When you estimate the population standard deviation from a sample, you’re trying to use a small subset of the population to estimate the variability in the entire population.</p>
<p>But, there’s an inherent problem here. When we calculate the standard deviation of a sample, we’re using the sample mean, not the population mean, because the population mean is usually unknown. The sample mean, being calculated from the data in the sample, is more likely to be closer to the individual data points in the sample than the population mean would be. This means the squared deviations from the sample mean are likely to be smaller, on average, than the squared deviations from the population mean. This is what leads to the underestimate of the variance, and hence the standard deviation, when we divide by <em>N</em>’ instead of <em>n - 1</em>.</p>
<p>Now, why <em>n - 1</em> instead of, say, <em>n - 2</em> or <em>n - 3</em>? This has to do with something in statistics known as ‘degrees of freedom’. Degrees of freedom are, in a way, the number of values that are free to vary given the constraints in the problem.</p>
<p>In the case of variance and standard deviation, the constraint is the sample mean. Once we’ve calculated the sample mean, the sum of the deviations from the mean must equal zero. This means that once we know the deviations of <em>n - 1</em> values, the deviation of the nth value is completely determined. So, we say we have <em>n - 1</em> degrees of freedom.</p>
<p>When you divide by <em>n - 1</em> instead of ‘n’, you are effectively adjusting the sample variance and sample standard deviation upwards to account for the fact that you’ve underestimated the squared deviations because you used the sample mean instead of the population mean. This adjustment gives a larger value for the sample variance and sample standard deviation, which on average gives a better (i.e., unbiased) estimate of the population variance and population standard deviation.</p>
<p>This visualization can demonstrate this effect: if you take many samples and calculate the sample standard deviation using <em>n</em> and <em>n - 1</em> in the denominator, you’ll see that the average of the sample standard deviations calculated with <em>n - 1</em> in the denominator will be closer to the true population standard deviation, while those calculated with ‘n’ in the denominator will tend to underestimate it. This shows how the <em>n - 1</em> adjustment corrects for the bias in estimating the population standard deviation from a sample.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="53" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 52;"><span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>jStat <span class="op">=</span> <span class="pp">require</span>(<span class="st">"https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="72" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 71;"><span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> <span class="dv">800</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="dv">400</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>maxWidth <span class="op">=</span> <span class="dv">900</span><span class="op">;</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>maxHeight <span class="op">=</span> <span class="dv">550</span><span class="op">;</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>timeseriesVertical <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>panelSpacing <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>populationPanelWidth <span class="op">=</span> maxWidth <span class="op">*</span> <span class="fl">0.6</span><span class="op">;</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>populationPanelHeight <span class="op">=</span> maxHeight<span class="op">;</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>populationSubPanelProportion <span class="op">=</span> <span class="fl">0.4</span><span class="op">;</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>sampleSubPanelProportion <span class="op">=</span> <span class="fl">0.05</span><span class="op">;</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>estimatesSubPanelProportion <span class="op">=</span> <span class="fl">0.55</span><span class="op">;</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>estimatesPanelWidth <span class="op">=</span> maxWidth <span class="op">-</span> populationPanelWidth<span class="op">;</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>estimatesPanelHeight <span class="op">=</span> populationPanelHeight<span class="op">;</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>timeSeriesPanelWidth <span class="op">=</span> maxWidth <span class="op">-</span> populationPanelWidth<span class="op">;</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>radius <span class="op">=</span> <span class="dv">4</span><span class="op">;</span> <span class="co">//1.4</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>sampleSize <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>xScalePopulation <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="op">-</span><span class="dv">4</span><span class="op">,</span> <span class="dv">4</span>])</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span> <span class="op">+</span> radius<span class="op">,</span> (populationPanelWidth) <span class="op">-</span> radius])</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>yScalePopulation <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">300</span>])</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([populationPanelHeight <span class="op">*</span> populationSubPanelProportion<span class="op">,</span> <span class="dv">0</span>])</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>xScaleEstimates <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="op">-</span><span class="fl">1.25</span><span class="op">,</span> <span class="fl">1.25</span>])</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> estimatesPanelWidth])</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>yScaleEstimates <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">20</span><span class="op">,</span> <span class="dv">0</span>])</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([maxHeight <span class="op">-</span> <span class="dv">30</span><span class="op">,</span> maxHeight <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> estimatesSubPanelProportion) <span class="op">+</span> <span class="dv">30</span>])</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>xAxisEstimatesValues <span class="op">=</span> [<span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>xAxisEstimates <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(xScalePopulation)</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickValues</span>(xAxisEstimatesValues)</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickFormat</span>(d <span class="kw">=&gt;</span> d)</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">tickSize</span>(<span class="op">-</span>maxHeight <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> estimatesSubPanelProportion) <span class="op">-</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-22" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="124" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 123;"><span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>update_svg <span class="op">=</span> {</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sample <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sampleData <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sample_estimates <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> running_averages <span class="op">=</span> [{<span class="dt">param</span><span class="op">:</span> <span class="st">"population"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span>]<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> [<span class="dv">0</span>]}<span class="op">,</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>                          {<span class="dt">param</span><span class="op">:</span> <span class="st">"sample"</span><span class="op">,</span>     <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span>]<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> [<span class="dv">0</span>]}<span class="op">,</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>                          {<span class="dt">param</span><span class="op">:</span> <span class="st">"mean"</span><span class="op">,</span>       <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span>]<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> [<span class="dv">0</span>]}]<span class="op">;</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> nSamplesDrawn <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> legendSelected <span class="op">=</span> [<span class="st">"sample"</span><span class="op">,</span> <span class="st">"population"</span>]</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> timeX<span class="op">,</span> timeY<span class="op">,</span> biasLine<span class="op">,</span> timeXAxis<span class="op">,</span> timeYAxis<span class="op">;</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> timeSvg<span class="op">,</span> </span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>  timeScaleBias<span class="op">,</span> </span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>  timeScaleId<span class="op">,</span> </span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>  timeBiasAxis<span class="op">,</span> </span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>  timeIdAxis<span class="op">,</span> </span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>  timeseriesDataLayer<span class="op">,</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>  timeseriesBiasAxisLayer<span class="op">,</span></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>  timeseriesIdAxisLayer<span class="op">;</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> isLargeScreen<span class="op">;</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">newSample</span>() {</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>    nSamplesDrawn<span class="op">++</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>    <span class="co">// pick random observations from the population by their index</span></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> sampleSize<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> randomIndex <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> popData<span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>      sample[i] <span class="op">=</span> xScalePopulation<span class="op">.</span><span class="fu">invert</span>(popData[randomIndex]<span class="op">.</span><span class="at">cx</span>)<span class="op">;</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>      sampleData[i] <span class="op">=</span> popData[randomIndex]<span class="op">;</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> estimates <span class="op">=</span> <span class="fu">getSampleEstimates</span>(sample)</span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>    estimates<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">=</span> nSamplesDrawn)<span class="op">;</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>    sample_estimates<span class="op">.</span><span class="fu">push</span>(estimates)</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateRunningAverages</span>(estimates)<span class="op">;</span></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateBiasChart</span>()<span class="op">;</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateSampleCircles</span>()<span class="op">;</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">animateEstimates</span>(sampleData<span class="op">,</span> estimates)<span class="op">;</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updatePath</span>()<span class="op">;</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateVisibility</span>()<span class="op">;</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateBiasChart</span>() {</span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>      yScaleEstimates<span class="op">.</span><span class="fu">domain</span>([nSamplesDrawn<span class="op">-</span><span class="dv">20</span><span class="op">,</span> nSamplesDrawn])</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>      biasDots<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>      biasDots<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">data</span>(sample_estimates<span class="op">.</span><span class="fu">flat</span>())</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">param</span> <span class="op">+</span> <span class="st">"-estimate"</span>)</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">symbol</span>()<span class="op">.</span><span class="fu">type</span>(d3<span class="op">.</span><span class="at">symbolSquare</span>)<span class="op">.</span><span class="fu">size</span>(radius <span class="op">*</span> radius <span class="op">*</span> <span class="dv">2</span>))</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="fu">xScalePopulation</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span><span class="fu">yScaleEstimates</span>(d<span class="op">.</span><span class="at">id</span> <span class="op">+</span> <span class="dv">1</span>)<span class="sc">}</span><span class="vs">) rotate(45)`</span>)</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> d <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> nSamplesDrawn <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="dv">1</span>))</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="fu">xScalePopulation</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span><span class="fu">yScaleEstimates</span>(d<span class="op">.</span><span class="at">id</span>)<span class="sc">}</span><span class="vs">) rotate(45)`</span>)</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateSampleCircles</span>() {</span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> durationMultiplier <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (playing) durationMultiplier <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>    sampleCircles<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>    sampleCircles<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)</span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(sampleData)</span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()<span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"sample"</span>)</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> radius)</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">cx</span>)</span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">yScalePopulation</span>(d<span class="op">.</span><span class="at">cy</span>))</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">fill</span>)</span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">duration</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">cy</span> <span class="op">*</span> durationMultiplier)</span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeBounceOut</span>)</span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> populationPanelHeight <span class="op">*</span> (populationSubPanelProportion <span class="op">+</span> sampleSubPanelProportion) <span class="op">-</span> radius)</span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">animateEstimates</span>(sampleData<span class="op">,</span> estimates) {</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>    sampleEstimatesTemp<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> wait <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="op">...</span>sampleData<span class="op">.</span><span class="fu">map</span>(z <span class="kw">=&gt;</span> z<span class="op">.</span><span class="at">cy</span>))<span class="op">;</span></span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> estimates<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> p <span class="op">=</span> estimates[i]<span class="op">.</span><span class="at">param</span><span class="op">;</span></span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> endPosition <span class="op">=</span> estimates[i]<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> dur <span class="op">=</span> (playing <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> convergeWait <span class="op">=</span> (playing <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> wait <span class="op">*</span> <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> moveDownWait <span class="op">=</span> (playing <span class="op">?</span> <span class="dv">250</span> <span class="op">:</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>    sampleData<span class="op">.</span><span class="fu">forEach</span>((s) <span class="kw">=&gt;</span> {</span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>    <span class="co">// first, place estimate symbols where each sample dot lands</span></span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>      sampleEstimatesTemp</span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> p <span class="op">+</span> <span class="st">"-estimate"</span>)</span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">symbol</span>()<span class="op">.</span><span class="fu">type</span>(d3<span class="op">.</span><span class="at">symbolSquare</span>)<span class="op">.</span><span class="fu">size</span>(radius <span class="op">*</span> radius <span class="op">*</span> <span class="dv">2</span>))</span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>s<span class="op">.</span><span class="at">cx</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>populationPanelHeight <span class="op">*</span> (populationSubPanelProportion <span class="op">+</span> sampleSubPanelProportion) <span class="op">-</span> radius<span class="sc">}</span><span class="vs">) rotate(45)`</span>)</span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>    <span class="co">// then move them all to the estimate</span></span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">transition</span>()<span class="op">.</span><span class="fu">duration</span>(dur <span class="op">*</span> <span class="fl">0.67</span>)<span class="op">.</span><span class="fu">delay</span>(convergeWait)</span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="fu">xScalePopulation</span>(endPosition)<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>populationPanelHeight <span class="op">*</span> (populationSubPanelProportion <span class="op">+</span> sampleSubPanelProportion) <span class="op">-</span> radius<span class="sc">}</span><span class="vs">) rotate(45)`</span>)</span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>    <span class="co">// then move them down to the estimates tracker</span></span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">transition</span>()<span class="op">.</span><span class="fu">duration</span>((playing <span class="op">?</span> <span class="dv">250</span> <span class="op">:</span> (dur <span class="op">*</span> <span class="fl">0.33</span>)))<span class="op">.</span><span class="fu">delay</span>(<span class="dv">0</span>)</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeCubicOut</span>)</span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="fu">xScalePopulation</span>(endPosition)<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span><span class="fu">yScaleEstimates</span>(nSamplesDrawn)<span class="sc">}</span><span class="vs">) rotate(45)`</span>)</span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sleep <span class="op">=</span> (milliseconds) <span class="kw">=&gt;</span> {</span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>(resolve <span class="kw">=&gt;</span> <span class="pp">setTimeout</span>(resolve<span class="op">,</span> milliseconds))</span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> playing <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">playButtonClicked</span>() {</span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>    playing <span class="op">=</span> <span class="op">!</span>playing<span class="op">;</span> </span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>  play_button<span class="op">.</span><span class="fu">text</span>(<span class="kw">function</span>(){</span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(playing) {</span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>      play_button<span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"btn btn-danger"</span>)</span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">"◼"</span></span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>    play_button<span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"btn btn-outline-success"</span>)</span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"▶"</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (playing) {</span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">continuouslyDrawSamples</span>()<span class="op">;</span></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">continuouslyDrawSamples</span>() {</span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (playing) {</span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>      <span class="fu">newSample</span>()<span class="op">;</span></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sleep</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">then</span>(continuouslyDrawSamples)<span class="op">;</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> popData <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> color <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleOrdinal</span>(d3<span class="op">.</span><span class="at">schemeCategory10</span>)<span class="op">;</span></span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> population<span class="op">.</span><span class="at">length</span><span class="op">;</span> <span class="op">++</span>i) {</span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cx <span class="op">=</span> <span class="fu">xScalePopulation</span>(population[i])<span class="op">;</span></span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cy <span class="op">=</span> <span class="dv">10</span> <span class="op">+</span> (<span class="fu">dodge</span>(cx) <span class="op">-</span> radius <span class="op">-</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> <span class="kw">const</span> cy <span class="op">=</span> <span class="fu">yScalePopulation</span>(<span class="fu">dodge</span>(cx))<span class="op">;</span> <span class="op">--&gt;</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> fill <span class="op">=</span> <span class="fu">color</span>(i <span class="op">%</span> <span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a>    popData<span class="op">.</span><span class="fu">push</span>({cx<span class="op">,</span> cy<span class="op">,</span> fill})</span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> populationLabels <span class="op">=</span> [{<span class="dt">label</span><span class="op">:</span> <span class="st">"Population"</span><span class="op">,</span> <span class="dt">top</span><span class="op">:</span> <span class="dv">0</span>}<span class="op">,</span></span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a>                            {<span class="dt">label</span><span class="op">:</span> <span class="st">"Sample"</span><span class="op">,</span>     <span class="dt">top</span><span class="op">:</span> (panelSpacing <span class="op">/</span>  maxHeight <span class="op">+</span> populationSubPanelProportion) <span class="op">*</span> <span class="dv">100</span>}<span class="op">,</span></span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>                            {<span class="dt">label</span><span class="op">:</span> <span class="st">"Under/over-&lt;/br&gt;estimation of&lt;/br&gt;parameter"</span><span class="op">,</span>     <span class="dt">top</span><span class="op">:</span> (panelSpacing <span class="op">/</span>  maxHeight <span class="op">+</span> populationSubPanelProportion <span class="op">+</span> sampleSubPanelProportion) <span class="op">*</span> <span class="dv">100</span>}]</span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> populationContainer <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"#population-container"</span>)</span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"relative"</span>)</span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> <span class="op">.</span><span class="fu">style</span>(<span class="st">"height"</span><span class="op">,</span> maxHeight) <span class="op">--&gt;</span></span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>    <span class="co">// panel labels</span></span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a>  populationContainer<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">data</span>(populationLabels)<span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)</span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">html</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">label</span>)</span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"panel-label"</span>)</span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">top</span> <span class="op">+</span> <span class="st">"%"</span>)</span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"line-height"</span><span class="op">,</span> <span class="st">"1em"</span>)</span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> populationAndSampleSvg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"#population-container"</span>)</span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"svg"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"populationAndSample-svg"</span>)</span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"preserveAspectRatio"</span><span class="op">,</span> <span class="st">"xMinYMin meet"</span>)</span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> <span class="st">"0 0 "</span> <span class="op">+</span> (populationPanelWidth) <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> populationPanelHeight)</span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>    <span class="co">// panel backgrounds</span></span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a>  populationAndSampleSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> populationPanelWidth)</span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> populationPanelHeight <span class="op">*</span> populationSubPanelProportion)</span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"var(--population-panel-background)"</span>)</span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>  populationAndSampleSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> populationPanelWidth)</span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> panelSpacing <span class="op">+</span> populationPanelHeight <span class="op">*</span> populationSubPanelProportion)</span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> populationPanelHeight <span class="op">*</span> sampleSubPanelProportion <span class="op">-</span> panelSpacing)</span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"var(--sample-panel-background)"</span>)</span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>  populationAndSampleSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> populationPanelWidth)</span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> panelSpacing <span class="op">+</span> populationPanelHeight <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> estimatesSubPanelProportion))</span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> populationPanelHeight <span class="op">*</span> estimatesSubPanelProportion <span class="op">-</span> panelSpacing)</span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"var(--estimates-panel-background)"</span>)</span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pop <span class="op">=</span> populationAndSampleSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> parameters <span class="op">=</span> populationAndSampleSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sampleEstimates <span class="op">=</span> populationAndSampleSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sampleEstimatesTemp <span class="op">=</span> populationAndSampleSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sampleCircles <span class="op">=</span> populationAndSampleSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> biasDots  <span class="op">=</span> sampleEstimates<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a>  pop<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(popData)</span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"pop"</span>)</span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">cx</span>)</span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">yScalePopulation</span>(d<span class="op">.</span><span class="at">cy</span>))</span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> radius)</span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">fill</span>)</span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a>    <span class="co">// estimates axis</span></span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> estimatesAxis <span class="op">=</span> sampleEstimates<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span><span class="fu">yScaleEstimates</span>(<span class="dv">21</span>)<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>  estimatesAxis<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> populationPanelWidth)</span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> populationPanelHeight <span class="op">-</span> <span class="fu">yScaleEstimates</span>(<span class="dv">21</span>))</span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"var(--estimates-panel-background)"</span>)</span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a>  estimatesAxis<span class="op">.</span><span class="fu">call</span>(xAxisEstimates)</span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a>  estimatesAxis<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatAxes</span>(estimatesAxis<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>))<span class="op">;</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> legendStatus <span class="op">=</span> [{<span class="dt">param</span><span class="op">:</span> <span class="st">"mean"</span><span class="op">,</span>       <span class="dt">hide</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>                      {<span class="dt">param</span><span class="op">:</span> <span class="st">"population"</span><span class="op">,</span> <span class="dt">hide</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span></span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>                      {<span class="dt">param</span><span class="op">:</span> <span class="st">"sample"</span><span class="op">,</span>     <span class="dt">hide</span><span class="op">:</span> <span class="kw">false</span>}]</span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateLegendStatus</span>(param) {</span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> index<span class="op">;</span></span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (param<span class="op">===</span><span class="st">"mean"</span>) {index <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>}</span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (param<span class="op">===</span><span class="st">"population"</span>) {index <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>}</span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (param<span class="op">===</span><span class="st">"sample"</span>) {index <span class="op">=</span> <span class="dv">2</span><span class="op">;</span>}</span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a>    legendStatus[index]<span class="op">.</span><span class="at">hide</span> <span class="op">=</span> <span class="op">!</span>legendStatus[index]<span class="op">.</span><span class="at">hide</span></span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> classes <span class="op">=</span> <span class="st">"#"</span> <span class="op">+</span> param <span class="op">+</span> <span class="st">"-estimate"</span></span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a>    populationAndSampleSvg<span class="op">.</span><span class="fu">selectAll</span>(classes)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"hide"</span><span class="op">,</span> legendStatus[index]<span class="op">.</span><span class="at">hide</span>)</span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a>    timeSvg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#"</span> <span class="op">+</span> param <span class="op">+</span> <span class="st">"-path"</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"hide"</span><span class="op">,</span> legendStatus[index]<span class="op">.</span><span class="at">hide</span>)</span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">.</span><span class="fu">classed</span>(<span class="st">"unselected"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">hide</span>)</span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> legend <span class="op">=</span> d3<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".selector"</span>)</span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a>    legend</span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(legendStatus)</span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">classed</span>(<span class="st">"unselected"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">hide</span>)</span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> <span class="kw">function</span>(<span class="bu">event</span><span class="op">,</span> d){<span class="fu">updateLegendStatus</span>(d<span class="op">.</span><span class="at">param</span>)<span class="op">;</span>})</span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a>  <span class="co">// buttons</span></span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> controls <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"#controls-container"</span>)</span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> reset_button <span class="op">=</span> controls<span class="op">.</span><span class="fu">append</span>(<span class="st">"button"</span>)</span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"btn btn-outline-primary"</span>)</span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .attr("type", "button")</span></span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Reset"</span>)</span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> clearData)</span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> button <span class="op">=</span> controls<span class="op">.</span><span class="fu">append</span>(<span class="st">"button"</span>)</span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"btn btn-outline-primary"</span>)</span>
<span id="cb3-414"><a href="#cb3-414" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Take one sample"</span>)</span>
<span id="cb3-415"><a href="#cb3-415" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> newSample)</span>
<span id="cb3-416"><a href="#cb3-416" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-417"><a href="#cb3-417" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> play_button <span class="op">=</span> controls<span class="op">.</span><span class="fu">append</span>(<span class="st">"button"</span>)</span>
<span id="cb3-418"><a href="#cb3-418" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"play-button"</span>)</span>
<span id="cb3-419"><a href="#cb3-419" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"btn btn-outline-success"</span>)</span>
<span id="cb3-420"><a href="#cb3-420" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .attr("class", "button invertable")</span></span>
<span id="cb3-421"><a href="#cb3-421" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb3-422"><a href="#cb3-422" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> h <span class="op">-</span> <span class="dv">50</span>)</span>
<span id="cb3-423"><a href="#cb3-423" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"▶"</span>)</span>
<span id="cb3-424"><a href="#cb3-424" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> playButtonClicked)</span>
<span id="cb3-425"><a href="#cb3-425" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-426"><a href="#cb3-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-427"><a href="#cb3-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-428"><a href="#cb3-428" aria-hidden="true" tabindex="-1"></a><span class="co">// make timeseries chart</span></span>
<span id="cb3-429"><a href="#cb3-429" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> timeChart <span class="op">=</span> {</span>
<span id="cb3-430"><a href="#cb3-430" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> timeSeriesPanelWidth<span class="op">,</span></span>
<span id="cb3-431"><a href="#cb3-431" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> maxHeight<span class="op">,</span></span>
<span id="cb3-432"><a href="#cb3-432" aria-hidden="true" tabindex="-1"></a>    <span class="dt">margin</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">top</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">60</span>}</span>
<span id="cb3-433"><a href="#cb3-433" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-434"><a href="#cb3-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-435"><a href="#cb3-435" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> timeChartHorizontal <span class="op">=</span> {</span>
<span id="cb3-436"><a href="#cb3-436" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> populationPanelWidth<span class="op">,</span></span>
<span id="cb3-437"><a href="#cb3-437" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span></span>
<span id="cb3-438"><a href="#cb3-438" aria-hidden="true" tabindex="-1"></a>    <span class="dt">margin</span><span class="op">:</span> {<span class="dt">left</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">top</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">60</span>}</span>
<span id="cb3-439"><a href="#cb3-439" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-440"><a href="#cb3-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-441"><a href="#cb3-441" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> timeseriesContainer <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"#timeline-container"</span>)<span class="op">;</span></span>
<span id="cb3-442"><a href="#cb3-442" aria-hidden="true" tabindex="-1"></a>  timeseriesContainer<span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"relative"</span>)</span>
<span id="cb3-443"><a href="#cb3-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-444"><a href="#cb3-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateTimeseriesDimensions</span>(<span class="bu">window</span><span class="op">.</span><span class="at">innerWidth</span>)<span class="op">;</span></span>
<span id="cb3-445"><a href="#cb3-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-446"><a href="#cb3-446" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Re-render the chart whenever the window size changes</span></span>
<span id="cb3-447"><a href="#cb3-447" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"resize"</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="fu">updateTimeseriesDimensions</span>(<span class="bu">window</span><span class="op">.</span><span class="at">innerWidth</span>))<span class="op">;</span></span>
<span id="cb3-448"><a href="#cb3-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-449"><a href="#cb3-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-450"><a href="#cb3-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-451"><a href="#cb3-451" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateTimeseriesDimensions</span>(winWidth) {</span>
<span id="cb3-452"><a href="#cb3-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-453"><a href="#cb3-453" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> largeScreen <span class="op">=</span> winWidth <span class="op">&gt;</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb3-454"><a href="#cb3-454" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (largeScreen <span class="op">===</span> isLargeScreen) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb3-455"><a href="#cb3-455" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Update the screen state</span></span>
<span id="cb3-456"><a href="#cb3-456" aria-hidden="true" tabindex="-1"></a>    isLargeScreen <span class="op">=</span> largeScreen<span class="op">;</span></span>
<span id="cb3-457"><a href="#cb3-457" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-458"><a href="#cb3-458" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> params<span class="op">;</span></span>
<span id="cb3-459"><a href="#cb3-459" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> orientation <span class="op">=</span> (winWidth <span class="op">&gt;</span> <span class="dv">600</span>) <span class="op">?</span> <span class="st">"vertical"</span> <span class="op">:</span> <span class="st">"horizontal;"</span></span>
<span id="cb3-460"><a href="#cb3-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-461"><a href="#cb3-461" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(orientation)<span class="op">;</span></span>
<span id="cb3-462"><a href="#cb3-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-463"><a href="#cb3-463" aria-hidden="true" tabindex="-1"></a>  <span class="co">// first, set up chart dimensions and axes</span></span>
<span id="cb3-464"><a href="#cb3-464" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (winWidth <span class="op">&gt;</span> <span class="dv">600</span>) {</span>
<span id="cb3-465"><a href="#cb3-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-466"><a href="#cb3-466" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> timeChart<span class="op">;</span></span>
<span id="cb3-467"><a href="#cb3-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-468"><a href="#cb3-468" aria-hidden="true" tabindex="-1"></a>    timeScaleBias <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-469"><a href="#cb3-469" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>([<span class="op">-</span><span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.5</span>])</span>
<span id="cb3-470"><a href="#cb3-470" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">left</span><span class="op">,</span> params<span class="op">.</span><span class="at">width</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">right</span>])</span>
<span id="cb3-471"><a href="#cb3-471" aria-hidden="true" tabindex="-1"></a>    timeScaleId <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-472"><a href="#cb3-472" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">200</span>])</span>
<span id="cb3-473"><a href="#cb3-473" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">top</span><span class="op">,</span> params<span class="op">.</span><span class="at">height</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">bottom</span>])</span>
<span id="cb3-474"><a href="#cb3-474" aria-hidden="true" tabindex="-1"></a>    biasLine <span class="op">=</span> <span class="kw">function</span>(x<span class="op">,</span> y){</span>
<span id="cb3-475"><a href="#cb3-475" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb3-476"><a href="#cb3-476" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">x</span>(<span class="kw">function</span>(d<span class="op">,</span>i) { <span class="cf">return</span> <span class="fu">timeScaleBias</span>(x[i])<span class="op">;</span> })</span>
<span id="cb3-477"><a href="#cb3-477" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">y</span>(<span class="kw">function</span>(d<span class="op">,</span>i) { <span class="cf">return</span> <span class="fu">timeScaleId</span>(y[i])<span class="op">;</span> })</span>
<span id="cb3-478"><a href="#cb3-478" aria-hidden="true" tabindex="-1"></a>        (<span class="bu">Array</span>(x<span class="op">.</span><span class="at">length</span>))<span class="op">;</span></span>
<span id="cb3-479"><a href="#cb3-479" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-480"><a href="#cb3-480" aria-hidden="true" tabindex="-1"></a>    timeBiasAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisTop</span>(timeScaleBias)</span>
<span id="cb3-481"><a href="#cb3-481" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">ticks</span>(<span class="dv">5</span>)</span>
<span id="cb3-482"><a href="#cb3-482" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickSize</span>(<span class="op">-</span>(params<span class="op">.</span><span class="at">height</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">top</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">bottom</span>)) <span class="co">// 440</span></span>
<span id="cb3-483"><a href="#cb3-483" aria-hidden="true" tabindex="-1"></a>    timeIdAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisRight</span>(timeScaleId)<span class="op">.</span><span class="fu">tickSize</span>(<span class="dv">0</span>)</span>
<span id="cb3-484"><a href="#cb3-484" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-485"><a href="#cb3-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-486"><a href="#cb3-486" aria-hidden="true" tabindex="-1"></a>      params <span class="op">=</span> timeChartHorizontal<span class="op">;</span></span>
<span id="cb3-487"><a href="#cb3-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-488"><a href="#cb3-488" aria-hidden="true" tabindex="-1"></a>      timeScaleBias <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-489"><a href="#cb3-489" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>([<span class="op">-</span><span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.5</span>])</span>
<span id="cb3-490"><a href="#cb3-490" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([params<span class="op">.</span><span class="at">height</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">bottom</span><span class="op">,</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">top</span>])</span>
<span id="cb3-491"><a href="#cb3-491" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-492"><a href="#cb3-492" aria-hidden="true" tabindex="-1"></a>      timeScaleId <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-493"><a href="#cb3-493" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">200</span>])</span>
<span id="cb3-494"><a href="#cb3-494" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">left</span><span class="op">,</span> params<span class="op">.</span><span class="at">width</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">right</span>])</span>
<span id="cb3-495"><a href="#cb3-495" aria-hidden="true" tabindex="-1"></a>      biasLine <span class="op">=</span> <span class="kw">function</span>(x<span class="op">,</span> y){</span>
<span id="cb3-496"><a href="#cb3-496" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb3-497"><a href="#cb3-497" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">x</span>(<span class="kw">function</span>(d<span class="op">,</span>i) { <span class="cf">return</span> <span class="fu">timeScaleId</span>(y[i])<span class="op">;</span> })</span>
<span id="cb3-498"><a href="#cb3-498" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">y</span>(<span class="kw">function</span>(d<span class="op">,</span>i) { <span class="cf">return</span> <span class="fu">timeScaleBias</span>(x[i])<span class="op">;</span> })</span>
<span id="cb3-499"><a href="#cb3-499" aria-hidden="true" tabindex="-1"></a>          (<span class="bu">Array</span>(x<span class="op">.</span><span class="at">length</span>))<span class="op">;</span></span>
<span id="cb3-500"><a href="#cb3-500" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-501"><a href="#cb3-501" aria-hidden="true" tabindex="-1"></a>    timeIdAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(timeScaleId)</span>
<span id="cb3-502"><a href="#cb3-502" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickSize</span>(<span class="dv">0</span>)</span>
<span id="cb3-503"><a href="#cb3-503" aria-hidden="true" tabindex="-1"></a>    timeBiasAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(timeScaleBias)</span>
<span id="cb3-504"><a href="#cb3-504" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">ticks</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">tickSize</span>(<span class="op">-</span>params<span class="op">.</span><span class="at">width</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">left</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">right</span>)</span>
<span id="cb3-505"><a href="#cb3-505" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-506"><a href="#cb3-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-507"><a href="#cb3-507" aria-hidden="true" tabindex="-1"></a>  <span class="co">// then instantiate the chart svg itself</span></span>
<span id="cb3-508"><a href="#cb3-508" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"#timeline-container"</span>)<span class="op">.</span><span class="fu">select</span>(<span class="st">"svg"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-509"><a href="#cb3-509" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"#timeline-container"</span>)<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-510"><a href="#cb3-510" aria-hidden="true" tabindex="-1"></a>  timeSvg <span class="op">=</span> <span class="fu">makeTimeseriesChart</span>(params)<span class="op">;</span></span>
<span id="cb3-511"><a href="#cb3-511" aria-hidden="true" tabindex="-1"></a>  timeseriesDataLayer <span class="op">=</span> timeSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb3-512"><a href="#cb3-512" aria-hidden="true" tabindex="-1"></a>  timeseriesBiasAxisLayer <span class="op">=</span> timeSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"timeseries"</span>)<span class="op">;</span></span>
<span id="cb3-513"><a href="#cb3-513" aria-hidden="true" tabindex="-1"></a>  timeseriesIdAxisLayer <span class="op">=</span> timeSvg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"timeseries"</span>)<span class="op">;</span></span>
<span id="cb3-514"><a href="#cb3-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-515"><a href="#cb3-515" aria-hidden="true" tabindex="-1"></a>  <span class="co">// then place the axes</span></span>
<span id="cb3-516"><a href="#cb3-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">positionTimeAxes</span>(orientation<span class="op">,</span> params)<span class="op">;</span></span>
<span id="cb3-517"><a href="#cb3-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-518"><a href="#cb3-518" aria-hidden="true" tabindex="-1"></a>  <span class="co">// then draw the current data</span></span>
<span id="cb3-519"><a href="#cb3-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updatePath</span>()<span class="op">;</span></span>
<span id="cb3-520"><a href="#cb3-520" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-521"><a href="#cb3-521" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-522"><a href="#cb3-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-523"><a href="#cb3-523" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-524"><a href="#cb3-524" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">makeTimeseriesChart</span>(params) {</span>
<span id="cb3-525"><a href="#cb3-525" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-526"><a href="#cb3-526" aria-hidden="true" tabindex="-1"></a>    <span class="co">// text labels</span></span>
<span id="cb3-527"><a href="#cb3-527" aria-hidden="true" tabindex="-1"></a>    timeseriesContainer<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-528"><a href="#cb3-528" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)</span>
<span id="cb3-529"><a href="#cb3-529" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-530"><a href="#cb3-530" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"panel-label timeseries"</span>)</span>
<span id="cb3-531"><a href="#cb3-531" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Average under/over-estimation"</span>)</span>
<span id="cb3-532"><a href="#cb3-532" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-533"><a href="#cb3-533" aria-hidden="true" tabindex="-1"></a>  timeseriesContainer<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-534"><a href="#cb3-534" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)</span>
<span id="cb3-535"><a href="#cb3-535" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"line-height"</span><span class="op">,</span> <span class="st">"1em"</span>)</span>
<span id="cb3-536"><a href="#cb3-536" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"bottom"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-537"><a href="#cb3-537" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"right"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-538"><a href="#cb3-538" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-align"</span><span class="op">,</span> <span class="st">"right"</span>)</span>
<span id="cb3-539"><a href="#cb3-539" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"timeseries"</span>)</span>
<span id="cb3-540"><a href="#cb3-540" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">html</span>(<span class="st">"Total&lt;br&gt;samples"</span>)</span>
<span id="cb3-541"><a href="#cb3-541" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-542"><a href="#cb3-542" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"#timeline-container"</span>)</span>
<span id="cb3-543"><a href="#cb3-543" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"svg"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"timeline-svg"</span>)</span>
<span id="cb3-544"><a href="#cb3-544" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"preserveAspectRatio"</span><span class="op">,</span> <span class="st">"xMinYMin meet"</span>)</span>
<span id="cb3-545"><a href="#cb3-545" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> <span class="st">"0 0 "</span> <span class="op">+</span> params<span class="op">.</span><span class="at">width</span> <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> params<span class="op">.</span><span class="at">height</span>)</span>
<span id="cb3-546"><a href="#cb3-546" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-547"><a href="#cb3-547" aria-hidden="true" tabindex="-1"></a>    <span class="co">// background panel</span></span>
<span id="cb3-548"><a href="#cb3-548" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb3-549"><a href="#cb3-549" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> params<span class="op">.</span><span class="at">width</span>)</span>
<span id="cb3-550"><a href="#cb3-550" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> params<span class="op">.</span><span class="at">height</span>)</span>
<span id="cb3-551"><a href="#cb3-551" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb3-552"><a href="#cb3-552" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"var(--timeseries-panel-background)"</span>)</span>
<span id="cb3-553"><a href="#cb3-553" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-554"><a href="#cb3-554" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> svg<span class="op">;</span></span>
<span id="cb3-555"><a href="#cb3-555" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-556"><a href="#cb3-556" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-557"><a href="#cb3-557" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-558"><a href="#cb3-558" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-559"><a href="#cb3-559" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">positionTimeAxes</span>(orientation<span class="op">,</span> params) {</span>
<span id="cb3-560"><a href="#cb3-560" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (orientation <span class="op">===</span> <span class="st">"vertical"</span>) {</span>
<span id="cb3-561"><a href="#cb3-561" aria-hidden="true" tabindex="-1"></a>      timeseriesBiasAxisLayer<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb3-562"><a href="#cb3-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-563"><a href="#cb3-563" aria-hidden="true" tabindex="-1"></a>      timeseriesBiasAxisLayer<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb3-564"><a href="#cb3-564" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> params<span class="op">.</span><span class="at">width</span>)</span>
<span id="cb3-565"><a href="#cb3-565" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span>params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">top</span>)</span>
<span id="cb3-566"><a href="#cb3-566" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">top</span>)</span>
<span id="cb3-567"><a href="#cb3-567" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb3-568"><a href="#cb3-568" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"var(--timeseries-panel-background)"</span>)</span>
<span id="cb3-569"><a href="#cb3-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-570"><a href="#cb3-570" aria-hidden="true" tabindex="-1"></a>        timeseriesIdAxisLayer<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>params<span class="op">.</span><span class="at">width</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">right</span><span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb3-571"><a href="#cb3-571" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-572"><a href="#cb3-572" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb3-573"><a href="#cb3-573" aria-hidden="true" tabindex="-1"></a>      timeseriesIdAxisLayer<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>params<span class="op">.</span><span class="at">height</span> <span class="op">-</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">bottom</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb3-574"><a href="#cb3-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-575"><a href="#cb3-575" aria-hidden="true" tabindex="-1"></a>      <span class="co">// todo: this isn't positioned correctly</span></span>
<span id="cb3-576"><a href="#cb3-576" aria-hidden="true" tabindex="-1"></a>      timeseriesBiasAxisLayer<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb3-577"><a href="#cb3-577" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="op">-</span>params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">left</span>)</span>
<span id="cb3-578"><a href="#cb3-578" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">left</span>)</span>
<span id="cb3-579"><a href="#cb3-579" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> params<span class="op">.</span><span class="at">height</span>)</span>
<span id="cb3-580"><a href="#cb3-580" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb3-581"><a href="#cb3-581" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"var(--timeseries-panel-background)"</span>)</span>
<span id="cb3-582"><a href="#cb3-582" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-583"><a href="#cb3-583" aria-hidden="true" tabindex="-1"></a>      timeseriesBiasAxisLayer<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>params<span class="op">.</span><span class="at">margin</span><span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb3-584"><a href="#cb3-584" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-585"><a href="#cb3-585" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-586"><a href="#cb3-586" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-587"><a href="#cb3-587" aria-hidden="true" tabindex="-1"></a>    timeseriesIdAxisLayer<span class="op">.</span><span class="fu">call</span>(timeIdAxis)</span>
<span id="cb3-588"><a href="#cb3-588" aria-hidden="true" tabindex="-1"></a>    timeseriesBiasAxisLayer<span class="op">.</span><span class="fu">call</span>(timeBiasAxis)<span class="op">;</span></span>
<span id="cb3-589"><a href="#cb3-589" aria-hidden="true" tabindex="-1"></a>    timeseriesBiasAxisLayer<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-590"><a href="#cb3-590" aria-hidden="true" tabindex="-1"></a>    timeseriesIdAxisLayer<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-591"><a href="#cb3-591" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-592"><a href="#cb3-592" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatAxes</span>(timeSvg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>))<span class="op">;</span></span>
<span id="cb3-593"><a href="#cb3-593" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-594"><a href="#cb3-594" aria-hidden="true" tabindex="-1"></a>    timeSvg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"dark"</span><span class="op">,</span> <span class="kw">true</span>)</span>
<span id="cb3-595"><a href="#cb3-595" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-596"><a href="#cb3-596" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-597"><a href="#cb3-597" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-598"><a href="#cb3-598" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updatePath</span>() {</span>
<span id="cb3-599"><a href="#cb3-599" aria-hidden="true" tabindex="-1"></a>      timeseriesDataLayer<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-600"><a href="#cb3-600" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-601"><a href="#cb3-601" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (nSamplesDrawn <span class="op">&gt;</span> <span class="dv">201</span>) {</span>
<span id="cb3-602"><a href="#cb3-602" aria-hidden="true" tabindex="-1"></a>        timeScaleId<span class="op">.</span><span class="fu">domain</span>([nSamplesDrawn <span class="op">-</span> <span class="dv">200</span><span class="op">,</span> nSamplesDrawn])<span class="op">;</span></span>
<span id="cb3-603"><a href="#cb3-603" aria-hidden="true" tabindex="-1"></a>        <span class="co">// timeIdAxis = d3.axisRight(timeScaleId).tickSize(0);</span></span>
<span id="cb3-604"><a href="#cb3-604" aria-hidden="true" tabindex="-1"></a>        timeseriesIdAxisLayer<span class="op">.</span><span class="fu">call</span>(timeIdAxis)<span class="op">;</span></span>
<span id="cb3-605"><a href="#cb3-605" aria-hidden="true" tabindex="-1"></a>        timeseriesIdAxisLayer<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-606"><a href="#cb3-606" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-607"><a href="#cb3-607" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-608"><a href="#cb3-608" aria-hidden="true" tabindex="-1"></a>      timeseriesDataLayer<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"g"</span>)</span>
<span id="cb3-609"><a href="#cb3-609" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">data</span>(running_averages)</span>
<span id="cb3-610"><a href="#cb3-610" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-611"><a href="#cb3-611" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-612"><a href="#cb3-612" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"bias-paths"</span>)</span>
<span id="cb3-613"><a href="#cb3-613" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb3-614"><a href="#cb3-614" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">biasLine</span>(d<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">id</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)))</span>
<span id="cb3-615"><a href="#cb3-615" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">param</span> <span class="op">+</span> <span class="st">"-path"</span>)</span>
<span id="cb3-616"><a href="#cb3-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-617"><a href="#cb3-617" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-618"><a href="#cb3-618" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-619"><a href="#cb3-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-620"><a href="#cb3-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-621"><a href="#cb3-621" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">clearData</span>() {</span>
<span id="cb3-622"><a href="#cb3-622" aria-hidden="true" tabindex="-1"></a>    sample <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-623"><a href="#cb3-623" aria-hidden="true" tabindex="-1"></a>    sample_estimates <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-624"><a href="#cb3-624" aria-hidden="true" tabindex="-1"></a>    running_averages <span class="op">=</span> [{<span class="dt">param</span><span class="op">:</span> <span class="st">"population"</span><span class="op">,</span>   <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span>]<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> [<span class="dv">0</span>]}<span class="op">,</span></span>
<span id="cb3-625"><a href="#cb3-625" aria-hidden="true" tabindex="-1"></a>                          {<span class="dt">param</span><span class="op">:</span> <span class="st">"sample"</span><span class="op">,</span>     <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span>]<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> [<span class="dv">0</span>]}<span class="op">,</span></span>
<span id="cb3-626"><a href="#cb3-626" aria-hidden="true" tabindex="-1"></a>                          {<span class="dt">param</span><span class="op">:</span> <span class="st">"mean"</span><span class="op">,</span>       <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span>]<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> [<span class="dv">0</span>]}]<span class="op">;</span></span>
<span id="cb3-627"><a href="#cb3-627" aria-hidden="true" tabindex="-1"></a>    nSamplesDrawn <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-628"><a href="#cb3-628" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-629"><a href="#cb3-629" aria-hidden="true" tabindex="-1"></a>    timeScaleId<span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">200</span>])<span class="op">;</span></span>
<span id="cb3-630"><a href="#cb3-630" aria-hidden="true" tabindex="-1"></a>    timeseriesIdAxisLayer<span class="op">.</span><span class="fu">call</span>(timeIdAxis)<span class="op">;</span></span>
<span id="cb3-631"><a href="#cb3-631" aria-hidden="true" tabindex="-1"></a>    timeseriesIdAxisLayer<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-632"><a href="#cb3-632" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-633"><a href="#cb3-633" aria-hidden="true" tabindex="-1"></a>    sampleCircles<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'circle'</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-634"><a href="#cb3-634" aria-hidden="true" tabindex="-1"></a>    sampleEstimates<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-635"><a href="#cb3-635" aria-hidden="true" tabindex="-1"></a>    sampleEstimatesTemp<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-636"><a href="#cb3-636" aria-hidden="true" tabindex="-1"></a>    timeseriesDataLayer<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb3-637"><a href="#cb3-637" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-638"><a href="#cb3-638" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-639"><a href="#cb3-639" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateRunningAverages</span>(estimates) {</span>
<span id="cb3-640"><a href="#cb3-640" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-641"><a href="#cb3-641" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> cur_n <span class="op">=</span> nSamplesDrawn</span>
<span id="cb3-642"><a href="#cb3-642" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> prev_n <span class="op">=</span> cur_n <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb3-643"><a href="#cb3-643" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-644"><a href="#cb3-644" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> old <span class="op">=</span> running_averages[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span>[prev_n]</span>
<span id="cb3-645"><a href="#cb3-645" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> new_pop <span class="op">=</span> ((old <span class="op">*</span> prev_n) <span class="op">+</span> estimates[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span>)<span class="op">/</span>cur_n</span>
<span id="cb3-646"><a href="#cb3-646" aria-hidden="true" tabindex="-1"></a>      running_averages[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">push</span>(new_pop)</span>
<span id="cb3-647"><a href="#cb3-647" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-648"><a href="#cb3-648" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> old <span class="op">=</span> running_averages[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span>[prev_n]</span>
<span id="cb3-649"><a href="#cb3-649" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> new_sam <span class="op">=</span> ((old <span class="op">*</span> prev_n) <span class="op">+</span> estimates[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span>)<span class="op">/</span>cur_n</span>
<span id="cb3-650"><a href="#cb3-650" aria-hidden="true" tabindex="-1"></a>      running_averages[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">push</span>(new_sam)</span>
<span id="cb3-651"><a href="#cb3-651" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-652"><a href="#cb3-652" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> old <span class="op">=</span> running_averages[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span>[prev_n]</span>
<span id="cb3-653"><a href="#cb3-653" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> new_mea <span class="op">=</span> ((old <span class="op">*</span> prev_n) <span class="op">+</span> estimates[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span>)<span class="op">/</span>cur_n</span>
<span id="cb3-654"><a href="#cb3-654" aria-hidden="true" tabindex="-1"></a>      running_averages[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">push</span>(new_mea)</span>
<span id="cb3-655"><a href="#cb3-655" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-656"><a href="#cb3-656" aria-hidden="true" tabindex="-1"></a>      running_averages[<span class="dv">0</span>]<span class="op">.</span><span class="at">id</span><span class="op">.</span><span class="fu">push</span>(cur_n)</span>
<span id="cb3-657"><a href="#cb3-657" aria-hidden="true" tabindex="-1"></a>      running_averages[<span class="dv">1</span>]<span class="op">.</span><span class="at">id</span><span class="op">.</span><span class="fu">push</span>(cur_n)</span>
<span id="cb3-658"><a href="#cb3-658" aria-hidden="true" tabindex="-1"></a>      running_averages[<span class="dv">2</span>]<span class="op">.</span><span class="at">id</span><span class="op">.</span><span class="fu">push</span>(cur_n)</span>
<span id="cb3-659"><a href="#cb3-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-660"><a href="#cb3-660" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-661"><a href="#cb3-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-662"><a href="#cb3-662" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateVisibility</span>() {</span>
<span id="cb3-663"><a href="#cb3-663" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-664"><a href="#cb3-664" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> params <span class="op">=</span> [<span class="st">"mean"</span><span class="op">,</span> <span class="st">"population"</span><span class="op">,</span> <span class="st">"sample"</span>]</span>
<span id="cb3-665"><a href="#cb3-665" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-666"><a href="#cb3-666" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb3-667"><a href="#cb3-667" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> param <span class="op">=</span> params[i]</span>
<span id="cb3-668"><a href="#cb3-668" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> elementIds <span class="op">=</span> <span class="st">"#"</span> <span class="op">+</span> param <span class="op">+</span> <span class="st">"-estimate, #"</span> <span class="op">+</span> param <span class="op">+</span> <span class="st">"-line"</span></span>
<span id="cb3-669"><a href="#cb3-669" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-670"><a href="#cb3-670" aria-hidden="true" tabindex="-1"></a>      populationAndSampleSvg<span class="op">.</span><span class="fu">selectAll</span>(elementIds)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"hide"</span><span class="op">,</span> legendStatus[i]<span class="op">.</span><span class="at">hide</span>)</span>
<span id="cb3-671"><a href="#cb3-671" aria-hidden="true" tabindex="-1"></a>      <span class="op">&lt;!--</span> populationAndSampleSvg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#"</span> <span class="op">+</span> param <span class="op">+</span> <span class="st">"-estimate"</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"hide"</span><span class="op">,</span> legendStatus[i]<span class="op">.</span><span class="at">hide</span>) <span class="op">--&gt;</span></span>
<span id="cb3-672"><a href="#cb3-672" aria-hidden="true" tabindex="-1"></a>      timeSvg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#"</span> <span class="op">+</span> param <span class="op">+</span> <span class="st">"-path"</span>)<span class="op">.</span><span class="fu">classed</span>(<span class="st">"hide"</span><span class="op">,</span> legendStatus[i]<span class="op">.</span><span class="at">hide</span>)</span>
<span id="cb3-673"><a href="#cb3-673" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-674"><a href="#cb3-674" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-675"><a href="#cb3-675" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-676"><a href="#cb3-676" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="687" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 686;"><span id="cb4-687"><a href="#cb4-687" aria-hidden="true" tabindex="-1"></a>dodger <span class="op">=</span> radius <span class="kw">=&gt;</span> {</span>
<span id="cb4-688"><a href="#cb4-688" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> radius2 <span class="op">=</span> radius <span class="op">**</span> <span class="fl">1.9</span><span class="op">;</span></span>
<span id="cb4-689"><a href="#cb4-689" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> bisect <span class="op">=</span> d3<span class="op">.</span><span class="fu">bisector</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>)<span class="op">;</span></span>
<span id="cb4-690"><a href="#cb4-690" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> circles <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb4-691"><a href="#cb4-691" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x <span class="kw">=&gt;</span> {</span>
<span id="cb4-692"><a href="#cb4-692" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> l <span class="op">=</span> bisect<span class="op">.</span><span class="fu">left</span>(circles<span class="op">,</span> x <span class="op">-</span> radius)<span class="op">;</span></span>
<span id="cb4-693"><a href="#cb4-693" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> r <span class="op">=</span> bisect<span class="op">.</span><span class="fu">right</span>(circles<span class="op">,</span> x <span class="op">+</span> radius<span class="op">,</span> l)<span class="op">;</span></span>
<span id="cb4-694"><a href="#cb4-694" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-695"><a href="#cb4-695" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> l<span class="op">;</span> i <span class="op">&lt;</span> r<span class="op">;</span> <span class="op">++</span>i) {</span>
<span id="cb4-696"><a href="#cb4-696" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> { <span class="dt">x</span><span class="op">:</span> xi<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> yi } <span class="op">=</span> circles[i]<span class="op">;</span></span>
<span id="cb4-697"><a href="#cb4-697" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> x2 <span class="op">=</span> (xi <span class="op">-</span> x) <span class="op">**</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb4-698"><a href="#cb4-698" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> y2 <span class="op">=</span> (yi <span class="op">-</span> y) <span class="op">**</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb4-699"><a href="#cb4-699" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (radius2 <span class="op">&gt;</span> x2 <span class="op">+</span> y2) {</span>
<span id="cb4-700"><a href="#cb4-700" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> yi <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(radius2 <span class="op">-</span> x2) <span class="op">+</span> <span class="fl">1e-6</span><span class="op">;</span></span>
<span id="cb4-701"><a href="#cb4-701" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> l <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-702"><a href="#cb4-702" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb4-703"><a href="#cb4-703" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-704"><a href="#cb4-704" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-705"><a href="#cb4-705" aria-hidden="true" tabindex="-1"></a>    circles<span class="op">.</span><span class="fu">splice</span>(bisect<span class="op">.</span><span class="fu">left</span>(circles<span class="op">,</span> x<span class="op">,</span> l<span class="op">,</span> r)<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> { x<span class="op">,</span> y })<span class="op">;</span></span>
<span id="cb4-706"><a href="#cb4-706" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> populationPanelHeight <span class="op">*</span> <span class="fl">0.7</span> <span class="op">-</span> d<span class="op">.</span><span class="at">cy</span> <span class="op">+</span> (radius <span class="op">*</span> <span class="dv">2</span>) <span class="op">--&gt;</span></span>
<span id="cb4-707"><a href="#cb4-707" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y<span class="op">;</span></span>
<span id="cb4-708"><a href="#cb4-708" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb4-709"><a href="#cb4-709" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-710"><a href="#cb4-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-711"><a href="#cb4-711" aria-hidden="true" tabindex="-1"></a>dodge <span class="op">=</span> <span class="fu">dodger</span>(radius <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.75</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="716" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 715;"><span id="cb5-716"><a href="#cb5-716" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">mean</span>(array) {</span>
<span id="cb5-717"><a href="#cb5-717" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> array<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b) <span class="op">/</span> array<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb5-718"><a href="#cb5-718" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-719"><a href="#cb5-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-720"><a href="#cb5-720" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">sample_variance</span>(array) {</span>
<span id="cb5-721"><a href="#cb5-721" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> n <span class="op">=</span> array<span class="op">.</span><span class="at">length</span></span>
<span id="cb5-722"><a href="#cb5-722" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="fu">mean</span>(array)</span>
<span id="cb5-723"><a href="#cb5-723" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> array<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(x <span class="op">-</span> m<span class="op">,</span> <span class="dv">2</span>))<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b) <span class="op">/</span> (n <span class="op">-</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb5-724"><a href="#cb5-724" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-725"><a href="#cb5-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-726"><a href="#cb5-726" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">population_variance</span>(array) {</span>
<span id="cb5-727"><a href="#cb5-727" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> n <span class="op">=</span> array<span class="op">.</span><span class="at">length</span></span>
<span id="cb5-728"><a href="#cb5-728" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="fu">mean</span>(array)</span>
<span id="cb5-729"><a href="#cb5-729" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> array<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(x <span class="op">-</span> m<span class="op">,</span> <span class="dv">2</span>))<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b) <span class="op">/</span> n<span class="op">;</span></span>
<span id="cb5-730"><a href="#cb5-730" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-731"><a href="#cb5-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-732"><a href="#cb5-732" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">get_descriptives</span> (array) {</span>
<span id="cb5-733"><a href="#cb5-733" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="dt">mean</span><span class="op">:</span> <span class="fu">mean</span>(array)<span class="op">,</span></span>
<span id="cb5-734"><a href="#cb5-734" aria-hidden="true" tabindex="-1"></a>            <span class="dt">sample_variance</span><span class="op">:</span> <span class="fu">sample_variance</span>(array) <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> </span>
<span id="cb5-735"><a href="#cb5-735" aria-hidden="true" tabindex="-1"></a>            <span class="dt">population_variance</span><span class="op">:</span> <span class="fu">population_variance</span>(array) <span class="op">-</span> <span class="dv">1</span>}</span>
<span id="cb5-736"><a href="#cb5-736" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-737"><a href="#cb5-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-738"><a href="#cb5-738" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getNewData</span> (array) {</span>
<span id="cb5-739"><a href="#cb5-739" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-740"><a href="#cb5-740" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="dt">sample_estimates</span><span class="op">:</span> <span class="fu">getSampleEstimates</span>(array)</span>
<span id="cb5-741"><a href="#cb5-741" aria-hidden="true" tabindex="-1"></a>            <span class="op">&lt;!--</span> <span class="dt">running_averages</span><span class="op">:</span> <span class="fu">getRunningAverages</span>(array) <span class="op">--&gt;</span></span>
<span id="cb5-742"><a href="#cb5-742" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb5-743"><a href="#cb5-743" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-744"><a href="#cb5-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-745"><a href="#cb5-745" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getSampleEstimates</span>(array) {</span>
<span id="cb5-746"><a href="#cb5-746" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [{<span class="dt">param</span><span class="op">:</span> <span class="st">"population"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">population_variance</span>(array) <span class="op">-</span> <span class="dv">1</span>}<span class="op">,</span></span>
<span id="cb5-747"><a href="#cb5-747" aria-hidden="true" tabindex="-1"></a>            {<span class="dt">param</span><span class="op">:</span> <span class="st">"sample"</span><span class="op">,</span>     <span class="dt">value</span><span class="op">:</span> <span class="fu">sample_variance</span>(array) <span class="op">-</span> <span class="dv">1</span>}<span class="op">,</span></span>
<span id="cb5-748"><a href="#cb5-748" aria-hidden="true" tabindex="-1"></a>            {<span class="dt">param</span><span class="op">:</span> <span class="st">"mean"</span><span class="op">,</span>       <span class="dt">value</span><span class="op">:</span> <span class="fu">mean</span>(array)}]</span>
<span id="cb5-749"><a href="#cb5-749" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-750"><a href="#cb5-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-751"><a href="#cb5-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-752"><a href="#cb5-752" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">formatAxes</span>(elements) {</span>
<span id="cb5-753"><a href="#cb5-753" aria-hidden="true" tabindex="-1"></a>  elements<span class="op">.</span><span class="at">_groups</span>[<span class="dv">0</span>]<span class="op">.</span><span class="fu">forEach</span>((l) <span class="kw">=&gt;</span> {</span>
<span id="cb5-754"><a href="#cb5-754" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (l<span class="op">.</span><span class="at">__data__</span> <span class="op">===</span> <span class="dv">0</span>) {</span>
<span id="cb5-755"><a href="#cb5-755" aria-hidden="true" tabindex="-1"></a>      l<span class="op">.</span><span class="at">classList</span> <span class="op">=</span> <span class="st">"axis-major"</span><span class="op">;</span></span>
<span id="cb5-756"><a href="#cb5-756" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-757"><a href="#cb5-757" aria-hidden="true" tabindex="-1"></a>      l<span class="op">.</span><span class="at">classList</span> <span class="op">=</span> <span class="st">"axis-minor"</span><span class="op">;</span></span>
<span id="cb5-758"><a href="#cb5-758" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-759"><a href="#cb5-759" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb5-760"><a href="#cb5-760" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-7" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<style type="text/css">

:root {
  --population-color: #eb8471;
  --sample-color: #41a1ff;
  --mean-color: #a495cf;
  --population-panel-background: #c3ddff;
  --sample-panel-background: #d3d8a8;
  --estimates-panel-background: #eee;
  --timeseries-panel-background: #333;
  --timeseries-panel-color: white;
}

.g-row {
  width: 100%;
}

.panel-label {
  text-transform: uppercase;
  justify: left;
  color: black;
}

.timeseries {
  color: var(--timeseries-panel-color);)
}

/* for desktop */
#population-container {
  float: left; 
  width: 59.7%;
}

#viz {
  margin: 1em auto 1em auto;
}

#timeline-container {
  color: var(--text-color-dark);
  float: right;
  width: 39.8%;
}

#controls {
  align-items: baseline;
  width: fit-content;
  display: flex;
  margin: auto;
}

#controls-container {
  color: var(--text-color);
  font-size: 0.8em;
  display: flex;
  align-items: center;
  width: fit-content;
  margin-right: 1em;
}

#select-estimates {
  width: fit-content;
  font-size: 0.7em;
}

@media screen and (max-width: 600px) {
  #population-container {
    width: 100%;
  }

  #timeline-container {
    width: 100%;
    margin-top: 1vw;
  }

  #controls {
    width: 100%;
    display: block;
  }
  #controls-container {
    width: fit-content;
    margin: auto;
  }

  #select-estimate {
    width: fit-content;
    margin: auto;
  }
}

.axis {
  font-size: 0.75em;
}
.bias-chart-title {
  font-size: 1.2em;
}
.axis-major {
  stroke: #aaa;
  stroke-width: 1;
}
.axis-minor {
  stroke: #ddd;
  stroke-width: 1;
}

.axis-major.dark {
  stroke: #ccc;
  stroke-width: 1;
}
.axis-minor.dark {
  stroke: #777;
  stroke-width: 1;
}


.sample {
  stroke: white;
}

#sample-estimate, #sample-line, #sample-legend {
  fill: var(--sample-color);
  stroke: var(--sample-color);
}

#mean-estimate, #mean-line, #mean-legend {
  fill:   var(--mean-color);
  stroke: var(--mean-color);
}

#population-estimate, #population-line, #population-legend {
  fill:   var(--population-color);
  stroke: var(--population-color);
}

.legend-unselected {
  fill-opacity: 0.1 !important;
}


.bias-paths {
  fill: none;
  stroke-width: 2;
}

#mean-path {
  stroke: var(--mean-color);
}
#sample-path {
  stroke: var(--sample-color);
}
#population-path {
  stroke: var(--population-color);
}

.hide {
  fill: none !important;
  stroke: none !important;
}


.button {
   font-family: Times;
}
.button:hover {
  fill: red;
  cursor: pointer;
}


.legend-dots:hover {
  cursor: pointer;
}


.selector {
  margin-right: 1em;
  cursor: pointer;
}
.selector::after {
  content: "";
  display: inline-block;
  width: 10px;
  height: 10px;
  transform: translate(50%, -10%) rotate(45deg);
}

.select-mean::after {
  background-color: var(--mean-color);
  border: 1px solid var(--mean-color);
}
.select-mean::after .unselected {
  background-color: "black";
  border: 1px solid var(--mean-color);
}
.select-population::after {
  background-color: var(--population-color);
  border: 1px solid var(--population-color);
}
.select-sample::after {
  background-color: var(--sample-color);
  border: 1px solid var(--sample-color);
}

.unselected::after {
  opacity: 0.2;
}

.unselected:hover::after {
  opacity: 0.5;
}

</style>
</div>


</section>

</main> <!-- /main -->

<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"jStat = require(\"https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js\")\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"w = 800\nh = 400\n\nmaxWidth = 900;\nmaxHeight = 550;\n\ntimeseriesVertical = false;\n\npanelSpacing = 5;\n\npopulationPanelWidth = maxWidth * 0.6;\npopulationPanelHeight = maxHeight;\n\npopulationSubPanelProportion = 0.4;\nsampleSubPanelProportion = 0.05;\n\nestimatesSubPanelProportion = 0.55;\n\nestimatesPanelWidth = maxWidth - populationPanelWidth;\nestimatesPanelHeight = populationPanelHeight;\n\ntimeSeriesPanelWidth = maxWidth - populationPanelWidth;\n\n\n\nradius = 4; //1.4\nsampleSize = 5;\n\n    \nxScalePopulation = d3.scaleLinear()\n    .domain([-4, 4])\n    .range([0 + radius, (populationPanelWidth) - radius])\nyScalePopulation = d3.scaleLinear()\n    .domain([0, 300])\n    .range([populationPanelHeight * populationSubPanelProportion, 0])\n\nxScaleEstimates = d3.scaleLinear()\n    .domain([-1.25, 1.25])\n    .range([0, estimatesPanelWidth])\n    \nyScaleEstimates = d3.scaleLinear()\n    .domain([20, 0])\n    .range([maxHeight - 30, maxHeight * (1 - estimatesSubPanelProportion) + 30])\n\nxAxisEstimatesValues = [-2, -1, 0, 1, 2];\nxAxisEstimates = d3.axisBottom(xScalePopulation)\n  .tickValues(xAxisEstimatesValues)\n  .tickFormat(d => d)\n  .tickSize(-maxHeight * (1 - estimatesSubPanelProportion) - 10)\n  \n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"update_svg = {\n\n  var sample = [];\n  var sampleData = [];\n  var sample_estimates = [];\n  var running_averages = [{param: \"population\", value: [0], id: [0]},\n                          {param: \"sample\",     value: [0], id: [0]},\n                          {param: \"mean\",       value: [0], id: [0]}];\n  \n  var nSamplesDrawn = 0;\n  \n  var legendSelected = [\"sample\", \"population\"]\n  \n  var timeX, timeY, biasLine, timeXAxis, timeYAxis;\n  var timeSvg, \n  timeScaleBias, \n  timeScaleId, \n  timeBiasAxis, \n  timeIdAxis, \n  timeseriesDataLayer,\n  timeseriesBiasAxisLayer,\n  timeseriesIdAxisLayer;\n\n  let isLargeScreen;\n\n  function newSample() {\n    \n    nSamplesDrawn++\n    \n    // pick random observations from the population by their index\n    for (var i = 0; i < sampleSize; i++) {\n      let randomIndex = Math.floor(Math.random() * popData.length);\n      sample[i] = xScalePopulation.invert(popData[randomIndex].cx);\n      sampleData[i] = popData[randomIndex];\n    }\n    \n    var estimates = getSampleEstimates(sample)\n    estimates.map(d => d.id = nSamplesDrawn);\n    sample_estimates.push(estimates)\n    \n    updateRunningAverages(estimates);\n    updateBiasChart();\n    updateSampleCircles();\n    animateEstimates(sampleData, estimates);\n    updatePath();\n    updateVisibility();\n  }\n  \n  function updateBiasChart() {\n      yScaleEstimates.domain([nSamplesDrawn-20, nSamplesDrawn])\n      \n      biasDots.selectAll(\"path\").remove()\n      biasDots.selectAll(\"path\")\n          .data(sample_estimates.flat())\n          .enter()\n          .append(\"path\")\n            .attr(\"id\", d => d.param + \"-estimate\")\n            .attr(\"d\", d3.symbol().type(d3.symbolSquare).size(radius * radius * 2))\n            .attr(\"transform\", d => `translate(${xScalePopulation(d.value)}, ${yScaleEstimates(d.id + 1)}) rotate(45)`)\n            .attr(\"opacity\", d => (d.id === nSamplesDrawn ? 0 : 1))\n            .transition()\n            .attr(\"transform\", d => `translate(${xScalePopulation(d.value)}, ${yScaleEstimates(d.id)}) rotate(45)`)\n            \n  }\n  \n\n  \n  function updateSampleCircles() {\n  \n  let durationMultiplier = 5;\n  if (playing) durationMultiplier = 1;\n  \n    sampleCircles.selectAll('circle').remove()\n    sampleCircles.selectAll('circle')\n      .data(sampleData)\n      .enter().append(\"circle\")\n      .attr(\"class\", \"sample\")\n      .attr(\"r\", radius)\n      .attr(\"cx\", d => d.cx)\n      .attr(\"cy\", d => yScalePopulation(d.cy))\n      .attr(\"fill\", d => d.fill)\n      .transition()\n      .duration(d => d.cy * durationMultiplier)\n      .ease(d3.easeBounceOut)\n      .attr(\"cy\", populationPanelHeight * (populationSubPanelProportion + sampleSubPanelProportion) - radius)\n  }\n  \n  \n  \n  function animateEstimates(sampleData, estimates) {\n  \n    sampleEstimatesTemp.selectAll(\"path\").remove()\n    \n    var wait = Math.max(...sampleData.map(z => z.cy));\n    \n    for (let i = 0; i < estimates.length; i++) {\n\n    var p = estimates[i].param;\n    var endPosition = estimates[i].value;\n    var dur = (playing ? 0 : 1000);\n    var convergeWait = (playing ? 0 : wait * 5);\n    var moveDownWait = (playing ? 250 : 0);\n    \n    sampleData.forEach((s) => {\n    \n    // first, place estimate symbols where each sample dot lands\n      sampleEstimatesTemp\n      .append(\"path\")\n      .attr(\"id\", p + \"-estimate\")\n      .attr(\"d\", d3.symbol().type(d3.symbolSquare).size(radius * radius * 2))\n        .attr(\"transform\", d => `translate(${s.cx}, ${populationPanelHeight * (populationSubPanelProportion + sampleSubPanelProportion) - radius}) rotate(45)`)\n        .attr(\"opacity\", 0)\n        \n    // then move them all to the estimate\n        .transition().duration(dur * 0.67).delay(convergeWait)\n        .attr(\"opacity\", 1)\n        .attr(\"transform\", d => `translate(${xScalePopulation(endPosition)}, ${populationPanelHeight * (populationSubPanelProportion + sampleSubPanelProportion) - radius}) rotate(45)`)\n        \n    // then move them down to the estimates tracker\n    .transition().duration((playing ? 250 : (dur * 0.33))).delay(0)\n      .ease(d3.easeCubicOut)\n        .attr(\"opacity\", 1)\n        .attr(\"transform\", `translate(${xScalePopulation(endPosition)}, ${yScaleEstimates(nSamplesDrawn)}) rotate(45)`)\n    })\n\n    }\n  }\n  \n  const sleep = (milliseconds) => {\n    return new Promise(resolve => setTimeout(resolve, milliseconds))\n  }\n  var playing = false;\n  function playButtonClicked() {\n    \n    playing = !playing; \n  \n  play_button.text(function(){\n    if(playing) {\n      play_button.attr(\"class\", \"btn btn-danger\")\n      return \"◼\"\n  } else {\n    play_button.attr(\"class\", \"btn btn-outline-success\")\n    return \"▶\"\n  }\n  })\n  \n  if (playing) {\n    continuouslyDrawSamples();\n  }\n  }\n  \n  function continuouslyDrawSamples() {\n    if (playing) {\n      newSample();\n      sleep(200).then(continuouslyDrawSamples);\n    }\n  }\n  \n    \n  var popData = [];\n  const color = d3.scaleOrdinal(d3.schemeCategory10);\n  for (let i = 0; i < population.length; ++i) {\n    const cx = xScalePopulation(population[i]);\n    const cy = 10 + (dodge(cx) - radius - 1);\n    <!-- const cy = yScalePopulation(dodge(cx)); -->\n    const fill = color(i % 10);\n    popData.push({cx, cy, fill})\n  }\n  \n  \n  \n  const populationLabels = [{label: \"Population\", top: 0},\n                            {label: \"Sample\",     top: (panelSpacing /  maxHeight + populationSubPanelProportion) * 100},\n                            {label: \"Under/over-</br>estimation of</br>parameter\",     top: (panelSpacing /  maxHeight + populationSubPanelProportion + sampleSubPanelProportion) * 100}]\n  \n  const populationContainer = d3.select(\"#population-container\")\n    .style(\"position\", \"relative\")\n    <!-- .style(\"height\", maxHeight) -->\n    \n    // panel labels\n  populationContainer.selectAll(\"text\").data(populationLabels).enter()\n    .append(\"text\")\n    .style(\"position\", \"absolute\")\n    .html(d => d.label)\n    .attr(\"class\", \"panel-label\")\n    .style(\"top\", d => d.top + \"%\")\n    .style(\"line-height\", \"1em\")\n\n  const populationAndSampleSvg = d3.select(\"#population-container\")\n    .append(\"svg\").attr(\"id\", \"populationAndSample-svg\")\n    .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n    .attr(\"viewBox\", \"0 0 \" + (populationPanelWidth) + \" \" + populationPanelHeight)\n    \n    // panel backgrounds\n  populationAndSampleSvg.append(\"rect\")\n    .attr(\"width\", populationPanelWidth)\n    .attr(\"height\", populationPanelHeight * populationSubPanelProportion)\n    .attr(\"fill\", \"var(--population-panel-background)\")\n    .attr(\"rx\", 5)\n  populationAndSampleSvg.append(\"rect\")\n    .attr(\"width\", populationPanelWidth)\n    .attr(\"y\", panelSpacing + populationPanelHeight * populationSubPanelProportion)\n    .attr(\"height\", populationPanelHeight * sampleSubPanelProportion - panelSpacing)\n    .attr(\"fill\", \"var(--sample-panel-background)\")\n    .attr(\"rx\", 5)\n  populationAndSampleSvg.append(\"rect\")\n    .attr(\"width\", populationPanelWidth)\n    .attr(\"y\", panelSpacing + populationPanelHeight * (1 - estimatesSubPanelProportion))\n    .attr(\"height\", populationPanelHeight * estimatesSubPanelProportion - panelSpacing)\n    .attr(\"fill\", \"var(--estimates-panel-background)\")\n    .attr(\"rx\", 5)\n    \n\n    \n  const pop = populationAndSampleSvg.append(\"g\")\n  const parameters = populationAndSampleSvg.append(\"g\")\n  const sampleEstimates = populationAndSampleSvg.append(\"g\")\n  const sampleEstimatesTemp = populationAndSampleSvg.append(\"g\")\n  const sampleCircles = populationAndSampleSvg.append(\"g\")\n\n  const biasDots  = sampleEstimates.append(\"g\")\n  \n  pop.selectAll(\"circle\")\n      .data(popData)\n      .enter()\n      .append(\"circle\")\n        .attr(\"class\", \"pop\")\n        .attr(\"cx\", d => d.cx)\n        .attr(\"cy\", d => yScalePopulation(d.cy))\n        .attr(\"r\", radius)\n        .attr(\"fill\", d => d.fill)\n        \n    // estimates axis\n    \n  const estimatesAxis = sampleEstimates.append(\"g\")\n    .attr(\"transform\", `translate(0, ${yScaleEstimates(21)})`)\n  \n  estimatesAxis.append(\"rect\")\n    .attr(\"width\", populationPanelWidth)\n    .attr(\"height\", populationPanelHeight - yScaleEstimates(21))\n    .attr(\"fill\", \"var(--estimates-panel-background)\")\n    .attr(\"rx\", 5)\n  estimatesAxis.call(xAxisEstimates)\n  estimatesAxis.select(\".domain\").remove()\n  \n\n\n  \n  formatAxes(estimatesAxis.selectAll(\"line\"));\n  \n    \n  var legendStatus = [{param: \"mean\",       hide: true},\n                      {param: \"population\", hide: false},\n                      {param: \"sample\",     hide: false}]\n                      \n  \n  function updateLegendStatus(param) {\n    var index;\n    if (param===\"mean\") {index = 0;}\n    if (param===\"population\") {index = 1;}\n    if (param===\"sample\") {index = 2;}\n    legendStatus[index].hide = !legendStatus[index].hide\n\n    var classes = \"#\" + param + \"-estimate\"\n    \n    populationAndSampleSvg.selectAll(classes).classed(\"hide\", legendStatus[index].hide)\n    timeSvg.selectAll(\"#\" + param + \"-path\").classed(\"hide\", legendStatus[index].hide)\n    legend.classed(\"unselected\", d => d.hide)\n  }\n  \n    const legend = d3.selectAll(\".selector\")\n    legend\n      .data(legendStatus)\n      .classed(\"unselected\", d => d.hide)\n      .on(\"click\", function(event, d){updateLegendStatus(d.param);})\n  \n\n\n  \n  // buttons\n  const controls = d3.select(\"#controls-container\")\n  \n  const reset_button = controls.append(\"button\")\n    .attr(\"class\", \"btn btn-outline-primary\")\n    // .attr(\"type\", \"button\")\n    .text(\"Reset\")\n    .on(\"click\", clearData)\n  \n  const button = controls.append(\"button\")\n    .attr(\"class\", \"btn btn-outline-primary\")\n    .text(\"Take one sample\")\n    .on(\"click\", newSample)\n    \n  const play_button = controls.append(\"button\")\n    .attr(\"id\", \"play-button\")\n    .attr(\"class\", \"btn btn-outline-success\")\n    // .attr(\"class\", \"button invertable\")\n    .attr(\"x\", 50)\n    .attr(\"y\", h - 50)\n    .text(\"▶\")\n    .on(\"click\", playButtonClicked)\n    \n\n\n// make timeseries chart\nconst timeChart = {\n    width: timeSeriesPanelWidth,\n    height: maxHeight,\n    margin: {left: 30, right: 30, top: 50, bottom: 60}\n}\n\nconst timeChartHorizontal = {\n    width: populationPanelWidth,\n    height: 300,\n    margin: {left: 30, right: 30, top: 50, bottom: 60}\n}\n\n  const timeseriesContainer = d3.select(\"#timeline-container\");\n  timeseriesContainer.style(\"position\", \"relative\")\n\n  updateTimeseriesDimensions(window.innerWidth);\n\n  // Re-render the chart whenever the window size changes\n  window.addEventListener(\"resize\", () => updateTimeseriesDimensions(window.innerWidth));\n\n\n\n  function updateTimeseriesDimensions(winWidth) {\n\n    const largeScreen = winWidth > 600;\n    if (largeScreen === isLargeScreen) return;\n    // Update the screen state\n    isLargeScreen = largeScreen;\n    \n  var params;\n  var orientation = (winWidth > 600) ? \"vertical\" : \"horizontal;\"\n\n  console.log(orientation);\n\n  // first, set up chart dimensions and axes\n  if (winWidth > 600) {\n\n    params = timeChart;\n\n    timeScaleBias = d3.scaleLinear()\n      .domain([-0.5, 0.5])\n      .range([params.margin.left, params.width - params.margin.right])\n    timeScaleId = d3.scaleLinear()\n      .domain([0, 200])\n      .range([params.margin.top, params.height - params.margin.bottom])\n    biasLine = function(x, y){\n        return d3.line()\n        .x(function(d,i) { return timeScaleBias(x[i]); })\n        .y(function(d,i) { return timeScaleId(y[i]); })\n        (Array(x.length));\n    }\n    timeBiasAxis = d3.axisTop(timeScaleBias)\n      .ticks(5)\n      .tickSize(-(params.height - params.margin.top - params.margin.bottom)) // 440\n    timeIdAxis = d3.axisRight(timeScaleId).tickSize(0)\n  } else {\n\n      params = timeChartHorizontal;\n\n      timeScaleBias = d3.scaleLinear()\n        .domain([-0.5, 0.5])\n        .range([params.height - params.margin.bottom, params.margin.top])\n        \n      timeScaleId = d3.scaleLinear()\n        .domain([0, 200])\n        .range([params.margin.left, params.width - params.margin.right])\n      biasLine = function(x, y){\n          return d3.line()\n          .x(function(d,i) { return timeScaleId(y[i]); })\n          .y(function(d,i) { return timeScaleBias(x[i]); })\n          (Array(x.length));\n      }\n    timeIdAxis = d3.axisBottom(timeScaleId)\n      .tickSize(0)\n    timeBiasAxis = d3.axisLeft(timeScaleBias)\n      .ticks(5).tickSize(-params.width - params.margin.left - params.margin.right)\n  }\n\n  // then instantiate the chart svg itself\n  d3.select(\"#timeline-container\").select(\"svg\").remove();\n  d3.select(\"#timeline-container\").selectAll(\"text\").remove();\n  timeSvg = makeTimeseriesChart(params);\n  timeseriesDataLayer = timeSvg.append(\"g\");\n  timeseriesBiasAxisLayer = timeSvg.append(\"g\").attr(\"class\", \"timeseries\");\n  timeseriesIdAxisLayer = timeSvg.append(\"g\").attr(\"class\", \"timeseries\");\n\n  // then place the axes\n  positionTimeAxes(orientation, params);\n\n  // then draw the current data\n  updatePath();\n}\n  \n\n  \n  function makeTimeseriesChart(params) {\n    \n    // text labels\n    timeseriesContainer.append(\"text\")\n    .style(\"position\", \"absolute\")\n    .style(\"left\", 0)\n    .attr(\"class\", \"panel-label timeseries\")\n    .text(\"Average under/over-estimation\")\n  \n  timeseriesContainer.append(\"text\")\n    .style(\"position\", \"absolute\")\n    .style(\"line-height\", \"1em\")\n    .style(\"bottom\", 0)\n    .style(\"right\", 0)\n    .style(\"text-align\", \"right\")\n    .attr(\"class\", \"timeseries\")\n    .html(\"Total<br>samples\")\n    \n    const svg = d3.select(\"#timeline-container\")\n    .append(\"svg\").attr(\"id\", \"timeline-svg\")\n    .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n    .attr(\"viewBox\", \"0 0 \" + params.width + \" \" + params.height)\n    \n    // background panel\n  svg.append(\"rect\")\n    .attr(\"width\", params.width)\n    .attr(\"height\", params.height)\n    .attr(\"rx\", 5)\n    .attr(\"fill\", \"var(--timeseries-panel-background)\")\n    \n    return svg;\n    \n  }\n  \n  \n  function positionTimeAxes(orientation, params) {\n    if (orientation === \"vertical\") {\n      timeseriesBiasAxisLayer.attr(\"transform\", `translate(0, ${params.margin.top})`)\n\n      timeseriesBiasAxisLayer.append(\"rect\")\n        .attr(\"width\", params.width)\n        .attr(\"y\", -params.margin.top)\n        .attr(\"height\", params.margin.top)\n        .attr(\"rx\", 5)\n        .attr(\"fill\", \"var(--timeseries-panel-background)\")\n\n        timeseriesIdAxisLayer.attr(\"transform\", `translate(${params.width - params.margin.right}, 0)`)\n  \n    } else {\n      timeseriesIdAxisLayer.attr(\"transform\", `translate(0, ${params.height - params.margin.bottom})`)\n\n      // todo: this isn't positioned correctly\n      timeseriesBiasAxisLayer.append(\"rect\")\n        .attr(\"x\", -params.margin.left)\n        .attr(\"width\", params.margin.left)\n        .attr(\"height\", params.height)\n        .attr(\"rx\", 5)\n        .attr(\"fill\", \"var(--timeseries-panel-background)\")\n      \n      timeseriesBiasAxisLayer.attr(\"transform\", `translate(${params.margin.left}, 0)`)\n        \n      \n    }\n    timeseriesIdAxisLayer.call(timeIdAxis)\n    timeseriesBiasAxisLayer.call(timeBiasAxis);\n    timeseriesBiasAxisLayer.select(\".domain\").remove();\n    timeseriesIdAxisLayer.select(\".domain\").remove();\n    \n    formatAxes(timeSvg.selectAll(\"line\"));\n    \n    timeSvg.selectAll(\"line\").classed(\"dark\", true)\n  }\n  \n  \n  function updatePath() {\n      timeseriesDataLayer.selectAll(\"g\").remove()\n      \n      if (nSamplesDrawn > 201) {\n        timeScaleId.domain([nSamplesDrawn - 200, nSamplesDrawn]);\n        // timeIdAxis = d3.axisRight(timeScaleId).tickSize(0);\n        timeseriesIdAxisLayer.call(timeIdAxis);\n        timeseriesIdAxisLayer.select(\".domain\").remove();\n      }\n      \n      timeseriesDataLayer.selectAll(\"g\")\n        .data(running_averages)\n        .enter()\n        .append(\"g\")\n        .attr(\"class\", \"bias-paths\")\n        .append(\"path\")\n          .attr(\"d\", d => biasLine(d.value.slice(1), d.id.slice(1)))\n          .attr(\"id\", d => d.param + \"-path\")\n\n  }\n  \n\n\nfunction clearData() {\n    sample = [];\n    sample_estimates = [];\n    running_averages = [{param: \"population\",   value: [0], id: [0]},\n                          {param: \"sample\",     value: [0], id: [0]},\n                          {param: \"mean\",       value: [0], id: [0]}];\n    nSamplesDrawn = 0;\n    \n    timeScaleId.domain([0, 200]);\n    timeseriesIdAxisLayer.call(timeIdAxis);\n    timeseriesIdAxisLayer.select(\".domain\").remove();\n    \n    sampleCircles.selectAll('circle').remove()\n    sampleEstimates.selectAll(\"path\").remove()\n    sampleEstimatesTemp.selectAll(\"path\").remove()\n    timeseriesDataLayer.selectAll(\"path\").remove()\n  }\n  \n  function updateRunningAverages(estimates) {\n  \n      var cur_n = nSamplesDrawn\n      var prev_n = cur_n - 1\n      \n      var old = running_averages[0].value[prev_n]\n      var new_pop = ((old * prev_n) + estimates[0].value)/cur_n\n      running_averages[0].value.push(new_pop)\n      \n      var old = running_averages[1].value[prev_n]\n      var new_sam = ((old * prev_n) + estimates[1].value)/cur_n\n      running_averages[1].value.push(new_sam)\n      \n      var old = running_averages[2].value[prev_n]\n      var new_mea = ((old * prev_n) + estimates[2].value)/cur_n\n      running_averages[2].value.push(new_mea)\n    \n      running_averages[0].id.push(cur_n)\n      running_averages[1].id.push(cur_n)\n      running_averages[2].id.push(cur_n)\n\n}\n\n  function updateVisibility() {\n  \n    var params = [\"mean\", \"population\", \"sample\"]\n    \n    for (var i = 0; i < 3; i++) {\n      var param = params[i]\n      var elementIds = \"#\" + param + \"-estimate, #\" + param + \"-line\"\n      \n      populationAndSampleSvg.selectAll(elementIds).classed(\"hide\", legendStatus[i].hide)\n      <!-- populationAndSampleSvg.selectAll(\"#\" + param + \"-estimate\").classed(\"hide\", legendStatus[i].hide) -->\n      timeSvg.selectAll(\"#\" + param + \"-path\").classed(\"hide\", legendStatus[i].hide)\n    }\n  }\n  \n}\n\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"\ndodger = radius => {\n  const radius2 = radius ** 1.9;\n  const bisect = d3.bisector(d => d.x);\n  const circles = [];\n  return x => {\n    const l = bisect.left(circles, x - radius);\n    const r = bisect.right(circles, x + radius, l);\n    let y = 0;\n    for (let i = l; i < r; ++i) {\n      const { x: xi, y: yi } = circles[i];\n      const x2 = (xi - x) ** 2;\n      const y2 = (yi - y) ** 2;\n      if (radius2 > x2 + y2) {\n        y = yi + Math.sqrt(radius2 - x2) + 1e-6;\n        i = l - 1;\n        continue;\n      }\n    }\n    circles.splice(bisect.left(circles, x, l, r), 0, { x, y });\n    <!-- populationPanelHeight * 0.7 - d.cy + (radius * 2) -->\n    return y;\n  };\n}\n\ndodge = dodger(radius * 2 + 0.75);\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"\nfunction mean(array) {\n    return array.reduce((a, b) => a + b) / array.length;\n}\n\nfunction sample_variance(array) {\n    const n = array.length\n    const m = mean(array)\n    return array.map(x => Math.pow(x - m, 2)).reduce((a, b) => a + b) / (n - 1);\n}\n\nfunction population_variance(array) {\n    const n = array.length\n    const m = mean(array)\n    return array.map(x => Math.pow(x - m, 2)).reduce((a, b) => a + b) / n;\n}\n\nfunction get_descriptives (array) {\n    return {mean: mean(array),\n            sample_variance: sample_variance(array) - 1, \n            population_variance: population_variance(array) - 1}\n}\n\nfunction getNewData (array) {\n    \n    return {sample_estimates: getSampleEstimates(array)\n            <!-- running_averages: getRunningAverages(array) -->\n            }\n}\n\nfunction getSampleEstimates(array) {\n    return [{param: \"population\", value: population_variance(array) - 1},\n            {param: \"sample\",     value: sample_variance(array) - 1},\n            {param: \"mean\",       value: mean(array)}]\n}\n\n\nfunction formatAxes(elements) {\n  elements._groups[0].forEach((l) => {\n    if (l.__data__ === 0) {\n      l.classList = \"axis-major\";\n    } else {\n      l.classList = \"axis-minor\";\n    }\n  })\n}\n\n"}]}
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../visualizations";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>